<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrafficPro - Sistema de Gestão de Tráfego Pago</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .sidebar-transition { transition: all 0.3s ease; }
        .card-hover { transition: all 0.2s ease; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .metric-card { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .metric-card-2 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .metric-card-3 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .metric-card-4 { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
        
        /* Responsividade - Mobile First */
        .sidebar-mobile { transform: translateX(-100%); }
        .sidebar-mobile.open { transform: translateX(0); }
        .main-content-mobile { margin-left: 0; }
        .main-content-desktop { margin-left: 16rem; }
        
        /* Overlay para mobile */
        .mobile-overlay { 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.5); 
            z-index: 40; 
            opacity: 0; 
            visibility: hidden; 
            transition: all 0.3s ease; 
        }
        .mobile-overlay.active { 
            opacity: 1; 
            visibility: visible; 
        }
        
        /* Ajustes para tablets */
        @media (min-width: 768px) and (max-width: 1023px) {
            .tablet-grid-2 { grid-template-columns: repeat(2, 1fr) !important; }
            .tablet-grid-1 { grid-template-columns: 1fr !important; }
            .tablet-text-sm { font-size: 0.875rem !important; }
            .tablet-p-4 { padding: 1rem !important; }
            .tablet-gap-4 { gap: 1rem !important; }
        }
        
        /* Ajustes para mobile */
        @media (max-width: 767px) {
            .mobile-grid-1 { grid-template-columns: 1fr !important; }
            .mobile-text-xs { font-size: 0.75rem !important; }
            .mobile-text-sm { font-size: 0.875rem !important; }
            .mobile-p-3 { padding: 0.75rem !important; }
            .mobile-p-4 { padding: 1rem !important; }
            .mobile-gap-3 { gap: 0.75rem !important; }
            .mobile-gap-4 { gap: 1rem !important; }
            .mobile-hidden { display: none !important; }
            .mobile-block { display: block !important; }
            .mobile-flex { display: flex !important; }
            .mobile-w-full { width: 100% !important; }
            .mobile-text-center { text-align: center !important; }
            .mobile-mb-4 { margin-bottom: 1rem !important; }
            .mobile-mt-4 { margin-top: 1rem !important; }
            .mobile-px-4 { padding-left: 1rem !important; padding-right: 1rem !important; }
            .mobile-py-2 { padding-top: 0.5rem !important; padding-bottom: 0.5rem !important; }
            .mobile-space-y-2 > * + * { margin-top: 0.5rem !important; }
            .mobile-space-x-2 > * + * { margin-left: 0.5rem !important; }
        }
        
        /* Tabelas responsivas */
        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        @media (max-width: 767px) {
            .table-responsive table {
                min-width: 600px;
            }
            .table-responsive th,
            .table-responsive td {
                padding: 0.5rem !important;
                font-size: 0.75rem !important;
            }
        }
        
        /* Cards responsivos */
        @media (max-width: 767px) {
            .metric-card,
            .metric-card-2,
            .metric-card-3,
            .metric-card-4 {
                padding: 1rem !important;
            }
            .metric-card .text-2xl,
            .metric-card-2 .text-2xl,
            .metric-card-3 .text-2xl,
            .metric-card-4 .text-2xl {
                font-size: 1.5rem !important;
            }
        }
        
        /* Modais responsivos */
        @media (max-width: 767px) {
            .modal-responsive {
                margin: 1rem !important;
                max-width: calc(100vw - 2rem) !important;
                max-height: calc(100vh - 2rem) !important;
                overflow-y: auto !important;
            }
        }
        
        /* Botões responsivos */
        @media (max-width: 767px) {
            .btn-responsive {
                padding: 0.5rem 0.75rem !important;
                font-size: 0.875rem !important;
            }
            .btn-group-responsive {
                flex-direction: column !important;
                gap: 0.5rem !important;
            }
            .btn-group-responsive > * {
                width: 100% !important;
            }
        }
        
        /* Charts responsivos */
        @media (max-width: 767px) {
            .chart-container {
                height: 200px !important;
            }
        }
        
        @media (min-width: 768px) and (max-width: 1023px) {
            .chart-container {
                height: 240px !important;
            }
        }
        
        /* Light Mode Styles (Default) */
        .light {
            background-color: #ffffff !important;
            color: #000000 !important;
        }
        .light body {
            background-color: #ffffff !important;
            color: #000000 !important;
        }
        
        /* ===== CONFIGURAÇÃO DAS CORES DOS NÚMEROS E TEXTOS DOS CARDS COLORIDOS ===== */
        /* ALTERE AQUI A COR DOS NÚMEROS E TEXTOS DOS CARDS DO DASHBOARD */
        .metric-card,
        .metric-card-2,
        .metric-card-3,
        .metric-card-4 {
            color: #ffffff !important; /* COR PRINCIPAL DOS TEXTOS - ALTERE AQUI */
        }
        .metric-card *,
        .metric-card-2 *,
        .metric-card-3 *,
        .metric-card-4 * {
            color: #ffffff !important; /* COR DE TODOS OS ELEMENTOS INTERNOS - ALTERE AQUI */
        }
        
        /* Forçar cores brancas em TODOS os modos e elementos específicos */
        .metric-card,
        .metric-card-2,
        .metric-card-3,
        .metric-card-4,
        .light .metric-card,
        .light .metric-card-2,
        .light .metric-card-3,
        .light .metric-card-4,
        .dark .metric-card,
        .dark .metric-card-2,
        .dark .metric-card-3,
        .dark .metric-card-4 {
            color: #ffffff !important;
        }
        .metric-card *,
        .metric-card-2 *,
        .metric-card-3 *,
        .metric-card-4 *,
        .light .metric-card *,
        .light .metric-card-2 *,
        .light .metric-card-3 *,
        .light .metric-card-4 *,
        .dark .metric-card *,
        .dark .metric-card-2 *,
        .dark .metric-card-3 *,
        .dark .metric-card-4 * {
            color: #ffffff !important;
        }
        
        /* Forçar especificamente os números e textos dos cards */
        .metric-card p,
        .metric-card-2 p,
        .metric-card-3 p,
        .metric-card-4 p,
        .light .metric-card p,
        .light .metric-card-2 p,
        .light .metric-card-3 p,
        .light .metric-card-4 p,
        .dark .metric-card p,
        .dark .metric-card-2 p,
        .dark .metric-card-3 p,
        .dark .metric-card-4 p {
            color: #ffffff !important;
        }
        .light .bg-gray-50 { 
            background-color: #f9fafb !important; 
            color: #000000 !important;
        }
        .light .bg-white {
            background-color: #ffffff !important;
            border: 1px solid #e5e7eb !important;
            color: #000000 !important;
        }
        .light .text-gray-800 { color: #1f2937 !important; }
        .light .text-gray-700 { color: #374151 !important; }
        .light .text-gray-600 { color: #4b5563 !important; }
        .light .text-gray-500 { color: #6b7280 !important; }
        .light .text-gray-400 { color: #9ca3af !important; }
        .light .text-gray-300 { color: #d1d5db !important; }
        .light .text-white { color: #000000 !important; }
        .light .border { border-color: #e5e7eb !important; }
        .light .border-gray-700 { border-color: #e5e7eb !important; }
        .light .border-b { border-bottom: 1px solid #e5e7eb !important; }
        .light .shadow-sm { 
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05) !important; 
        }
        .light .shadow-lg { 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1) !important; 
        }
        .light .divide-gray-200 > :not([hidden]) ~ :not([hidden]) { 
            border-color: #e5e7eb !important; 
        }
        .light .divide-gray-700 > :not([hidden]) ~ :not([hidden]) { 
            border-color: #e5e7eb !important; 
        }
        .light .hover\\:bg-gray-50:hover { 
            background-color: #f9fafb !important; 
        }
        .light .hover\\:bg-blue-50:hover { 
            background-color: #eff6ff !important; 
        }
        .light .hover\\:bg-gray-800:hover { 
            background-color: #f3f4f6 !important; 
        }
        .light .hover\\:text-blue-400:hover { 
            color: #3b82f6 !important; 
        }
        .light input, .light select, .light textarea { 
            background-color: #ffffff !important; 
            border-color: #d1d5db !important; 
            color: #000000 !important; 
        }
        .light input:focus, .light select:focus, .light textarea:focus {
            border-color: #3b82f6 !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
        }
        .light input::placeholder, .light textarea::placeholder { color: #9ca3af !important; }
        .light .card-hover:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1) !important;
        }
        .light .nav-item {
            color: #374151 !important;
        }
        .light .nav-item:hover {
            background-color: rgba(105, 116, 219, 0.3) !important;
            color: #6974DB !important;
        }
        .light .nav-item.bg-blue-50 {
            background-color: rgba(105, 116, 219, 0.3) !important;
            color: #6974DB !important;
        }
        .light thead {
            background-color: #f9fafb !important;
            color: #374151 !important;
        }
        .light thead th {
            color: #6b7280 !important;
        }
        .light tbody tr {
            border-bottom: 1px solid #e5e7eb !important;
            color: #000000 !important;
        }
        .light tbody tr:hover {
            background-color: #f9fafb !important;
        }
        .light tbody td {
            color: #000000 !important;
        }
        .light .fixed {
            background-color: rgba(255, 255, 255, 0.95) !important;
        }
        .light .rounded-xl,
        .light .rounded-lg {
            background-color: #ffffff !important;
            border: 1px solid #e5e7eb !important;
        }
        .light .bg-gray-900 {
            background-color: #ffffff !important;
            border: 1px solid #e5e7eb !important;
            color: #000000 !important;
        }
        .light .bg-gray-800 {
            background-color: #f9fafb !important;
            color: #000000 !important;
        }
        .light h1, .light h2, .light h3, .light h4, .light h5, .light h6 {
            color: #000000 !important;
        }
        .light p, .light span, .light div {
            color: inherit !important;
        }
        .light .text-sm {
            color: #4b5563 !important;
        }
        .light .font-medium, .light .font-semibold, .light .font-bold {
            color: #000000 !important;
        }
        .light .uppercase {
            color: #6b7280 !important;
        }
        /* Sidebar específico para modo light */
        .light #sidebar {
            background-color: #ffffff !important;
            border-right: 1px solid #e5e7eb !important;
            color: #000000 !important;
        }
        /* Header específico para modo light */
        .light header {
            background-color: #ffffff !important;
            border-bottom: 1px solid #e5e7eb !important;
            color: #000000 !important;
        }
        /* Modais específicos para modo light */
        .light .modal {
            background-color: #ffffff !important;
            color: #000000 !important;
        }
        /* Botões específicos para modo light */
        .light .bg-gray-100 {
            background-color: #f3f4f6 !important;
            color: #374151 !important;
        }
        .light .bg-gray-200 {
            background-color: #e5e7eb !important;
            color: #374151 !important;
        }
        .light .hover\\:bg-gray-200:hover {
            background-color: #d1d5db !important;
        }
        .light .hover\\:bg-gray-300:hover {
            background-color: #d1d5db !important;
        }
        /* Tags e badges específicos para modo light */
        .light .bg-blue-100 { background-color: #dbeafe !important; }
        .light .bg-green-100 { background-color: #dcfce7 !important; }
        .light .bg-yellow-100 { background-color: #fef3c7 !important; }
        .light .bg-red-100 { background-color: #fee2e2 !important; }
        .light .bg-purple-100 { background-color: #f3e8ff !important; }
        .light .bg-orange-100 { background-color: #fed7aa !important; }
        .light .bg-blue-50 { background-color: #eff6ff !important; }
        .light .bg-green-50 { background-color: #f0fdf4 !important; }
        .light .bg-yellow-50 { background-color: #fefce8 !important; }
        .light .bg-red-50 { background-color: #fef2f2 !important; }
        .light .bg-purple-50 { background-color: #faf5ff !important; }
        .light .bg-orange-50 { background-color: #fff7ed !important; }
        .light .text-blue-800 { color: #1e40af !important; }
        .light .text-green-800 { color: #166534 !important; }
        .light .text-yellow-800 { color: #92400e !important; }
        .light .text-red-800 { color: #991b1b !important; }
        .light .text-purple-800 { color: #6b21a8 !important; }
        .light .text-orange-800 { color: #9a3412 !important; }
        .light .text-blue-600 { color: #2563eb !important; }
        .light .text-green-600 { color: #16a34a !important; }
        .light .text-yellow-600 { color: #ca8a04 !important; }
        .light .text-red-600 { color: #dc2626 !important; }
        .light .text-purple-600 { color: #9333ea !important; }
        .light .text-orange-600 { color: #ea580c !important; }

        /* Dark Mode Styles */
        .dark {
            background-color: #000000 !important;
            color: #ffffff !important;
        }
        .dark .bg-white { 
            background-color: #0a0a0a !important; 
            border: 1px solid #333333 !important;
        }
        .dark .bg-gray-50 { 
            background-color: #1a1a1a !important; 
            border: 1px solid #333333 !important;
        }
        .dark body {
            background-color: #000000 !important;
        }
        .dark .bg-white:not(.gradient-bg),
        .dark .bg-gray-50:not(.gradient-bg),
        .dark .bg-gray-100:not(.gradient-bg),
        .dark .bg-gray-200:not(.gradient-bg) {
            background-color: #0a0a0a !important;
            border: 1px solid #333333 !important;
        }
        .dark .text-gray-800 { color: #ffffff !important; }
        .dark .text-gray-700 { color: #f0f0f0 !important; }
        .dark .text-gray-600 { color: #e0e0e0 !important; }
        .dark .text-gray-500 { color: #d0d0d0 !important; }
        .dark .border { border-color: #7c3aed !important; }
        .dark .shadow-sm { 
            box-shadow: 0 1px 2px 0 rgba(124, 58, 237, 0.3) !important; 
        }
        .dark .shadow-lg { 
            box-shadow: 0 10px 15px -3px rgba(124, 58, 237, 0.4) !important; 
        }
        .dark .divide-gray-200 > :not([hidden]) ~ :not([hidden]) { 
            border-color: #7c3aed !important; 
        }
        .dark .hover\\:bg-gray-50:hover { 
            background-color: #1a1a1a !important; 
            border-color: #333333 !important;
        }
        .dark .hover\\:bg-blue-50:hover { 
            background-color: #1a1a1a !important; 
            border-color: #333333 !important;
        }
        .dark input, .dark select, .dark textarea { 
            background-color: #1a1a1a !important; 
            border-color: #333333 !important; 
            color: #ffffff !important; 
        }
        .dark input:focus, .dark select:focus, .dark textarea:focus {
            border-color: #555555 !important;
            box-shadow: 0 0 0 3px rgba(85, 85, 85, 0.3) !important;
        }
        .dark input::placeholder, .dark textarea::placeholder { color: #d0d0d0 !important; }
        .dark .card-hover:hover {
            border-color: #333333 !important;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5) !important;
        }
        .dark .nav-item:hover {
            background-color: #1a1a1a !important;
            border-left: 3px solid #333333 !important;
        }
        .dark .nav-item.bg-blue-50 {
            background-color: #1a1a1a !important;
            border-left: 3px solid #333333 !important;
        }
        .dark thead {
            background-color: #1a1a1a !important;
            border-bottom: 2px solid #333333 !important;
        }
        .dark tbody tr {
            border-bottom: 1px solid #333333 !important;
        }
        .dark tbody tr:hover {
            background-color: #1a1a1a !important;
        }
        .dark .fixed {
            background-color: rgba(0, 0, 0, 0.9) !important;
        }
        .dark .rounded-xl,
        .dark .rounded-lg {
            background-color: #0a0a0a !important;
            border: 1px solid #333333 !important;
        }
        .dark .bg-blue-50,
        .dark .bg-green-50,
        .dark .bg-purple-50,
        .dark .bg-orange-50,
        .dark .bg-red-50,
        .dark .bg-yellow-50,
        .dark .bg-blue-100,
        .dark .bg-green-100,
        .dark .bg-purple-100,
        .dark .bg-orange-100,
        .dark .bg-red-100,
        .dark .bg-yellow-100 {
            background-color: #1a1a1a !important;
            border: 1px solid #333333 !important;
            color: #ffffff !important;
        }
        
        /* Manter gradientes dos cards de métricas no modo dark */
        .dark .metric-card,
        .dark .metric-card-2,
        .dark .metric-card-3,
        .dark .metric-card-4 {
            color: #ffffff !important;
        }
        
        /* Remove cores dos badges/tags no modo dark */
        .dark .text-blue-800,
        .dark .text-green-800,
        .dark .text-purple-800,
        .dark .text-orange-800,
        .dark .text-red-800,
        .dark .text-yellow-800 {
            color: #ffffff !important;
        }
    </style>
</head>
<body class="bg-gray-50 light:bg-white dark:bg-black">
    <!-- Mobile Overlay -->
    <div id="mobileOverlay" class="mobile-overlay lg:hidden" onclick="closeMobileSidebar()"></div>
    
    <!-- Sidebar -->
    <div id="sidebar" class="fixed left-0 top-0 h-full w-64 bg-white shadow-lg z-50 sidebar-transition dark:bg-gray-900 lg:translate-x-0 sidebar-mobile lg:sidebar-desktop">
        <div class="p-4 lg:p-6 gradient-bg text-white">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-lg lg:text-xl font-bold flex items-center">
                        <i class="fas fa-chart-line mr-2"></i>
                        TrafficPro
                    </h1>
                    <p class="text-xs lg:text-sm opacity-90 mt-1">Gestão de Tráfego Pago</p>
                </div>
                <button onclick="closeMobileSidebar()" class="lg:hidden text-white hover:text-gray-200">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
        </div>
        
        <nav class="mt-4 lg:mt-6 px-2 lg:px-0">
            <a href="#" onclick="showSection('dashboard'); closeMobileSidebar();" class="nav-item flex items-center px-4 lg:px-6 py-2 lg:py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-blue-400 rounded-lg lg:rounded-none mx-2 lg:mx-0 mb-1 lg:mb-0" style="--hover-bg: rgba(105, 116, 219, 0.3); --hover-color: #6974DB;">
                <i class="fas fa-tachometer-alt mr-3 text-sm lg:text-base"></i>
                <span class="text-sm lg:text-base">Dashboard</span>
            </a>
            <a href="#" onclick="showSection('clients'); closeMobileSidebar();" class="nav-item flex items-center px-4 lg:px-6 py-2 lg:py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-blue-400 rounded-lg lg:rounded-none mx-2 lg:mx-0 mb-1 lg:mb-0" style="--hover-bg: rgba(105, 116, 219, 0.3); --hover-color: #6974DB;">
                <i class="fas fa-users mr-3 text-sm lg:text-base"></i>
                <span class="text-sm lg:text-base">Clientes</span>
            </a>
            <a href="#" onclick="showSection('campaigns'); closeMobileSidebar();" class="nav-item flex items-center px-4 lg:px-6 py-2 lg:py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-blue-400 rounded-lg lg:rounded-none mx-2 lg:mx-0 mb-1 lg:mb-0" style="--hover-bg: rgba(105, 116, 219, 0.3); --hover-color: #6974DB;">
                <i class="fas fa-bullhorn mr-3 text-sm lg:text-base"></i>
                <span class="text-sm lg:text-base">Campanhas</span>
            </a>
            <a href="#" onclick="showSection('budget'); closeMobileSidebar();" class="nav-item flex items-center px-4 lg:px-6 py-2 lg:py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-blue-400 rounded-lg lg:rounded-none mx-2 lg:mx-0 mb-1 lg:mb-0" style="--hover-bg: rgba(105, 116, 219, 0.3); --hover-color: #6974DB;">
                <i class="fas fa-dollar-sign mr-3 text-sm lg:text-base"></i>
                <span class="text-sm lg:text-base">Orçamento</span>
            </a>
            <a href="#" onclick="showSection('analytics'); closeMobileSidebar();" class="nav-item flex items-center px-4 lg:px-6 py-2 lg:py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-blue-400 rounded-lg lg:rounded-none mx-2 lg:mx-0 mb-1 lg:mb-0" style="--hover-bg: rgba(105, 116, 219, 0.3); --hover-color: #6974DB;">
                <i class="fas fa-chart-bar mr-3 text-sm lg:text-base"></i>
                <span class="text-sm lg:text-base">Análises</span>
            </a>
            <a href="#" onclick="showSection('reports'); closeMobileSidebar();" class="nav-item flex items-center px-4 lg:px-6 py-2 lg:py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-blue-400 rounded-lg lg:rounded-none mx-2 lg:mx-0 mb-1 lg:mb-0" style="--hover-bg: rgba(105, 116, 219, 0.3); --hover-color: #6974DB;">
                <i class="fas fa-file-alt mr-3 text-sm lg:text-base"></i>
                <span class="text-sm lg:text-base">Relatórios</span>
            </a>
            <a href="#" onclick="showSection('integrations'); closeMobileSidebar();" class="nav-item flex items-center px-4 lg:px-6 py-2 lg:py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-blue-400 rounded-lg lg:rounded-none mx-2 lg:mx-0 mb-1 lg:mb-0" style="--hover-bg: rgba(105, 116, 219, 0.3); --hover-color: #6974DB;">
                <i class="fas fa-plug mr-3 text-sm lg:text-base"></i>
                <span class="text-sm lg:text-base">Integrações</span>
            </a>
            <a href="#" onclick="showSection('users'); closeMobileSidebar();" class="nav-item flex items-center px-4 lg:px-6 py-2 lg:py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-blue-400 rounded-lg lg:rounded-none mx-2 lg:mx-0 mb-1 lg:mb-0" style="--hover-bg: rgba(105, 116, 219, 0.3); --hover-color: #6974DB;">
                <i class="fas fa-user-cog mr-3 text-sm lg:text-base"></i>
                <span class="text-sm lg:text-base">Usuários</span>
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="lg:ml-64 min-h-screen main-content-mobile lg:main-content-desktop">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b px-4 lg:px-6 py-3 lg:py-4 dark:bg-gray-900 dark:border-gray-700">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <button onclick="openMobileSidebar()" class="lg:hidden mr-3 p-2 text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white">
                        <i class="fas fa-bars text-lg"></i>
                    </button>
                    <h2 id="page-title" class="text-lg lg:text-2xl font-semibold text-gray-800 dark:text-white">Dashboard</h2>
                </div>
                <div class="flex items-center space-x-2 lg:space-x-4">
                    <button id="darkModeToggle" onclick="toggleDarkMode()" class="bg-gray-100 text-gray-600 px-2 lg:px-3 py-2 rounded-lg hover:bg-gray-200 transition-colors dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 btn-responsive" title="Alternar modo escuro">
                        <i class="fas fa-moon text-sm lg:text-base"></i>
                    </button>
                    <button onclick="showSection('campaigns')" class="text-white px-3 lg:px-4 py-2 rounded-lg btn-responsive mobile-hidden" style="background-color: #677BE6;">
                        <i class="fas fa-plus mr-1 lg:mr-2"></i>
                        <span class="hidden sm:inline">Nova Campanha</span>
                        <span class="sm:hidden">Nova</span>
                    </button>
                    <div class="flex items-center space-x-2 mobile-hidden">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%234F46E5'/%3E%3Ctext x='16' y='20' text-anchor='middle' fill='white' font-family='Arial' font-size='12' font-weight='bold'%3EJM%3C/text%3E%3C/svg%3E" alt="User" class="w-6 lg:w-8 h-6 lg:h-8 rounded-full">
                        <span class="text-xs lg:text-sm font-medium dark:text-white hidden md:block">João Manager</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Dashboard Section -->
        <div id="dashboard-section" class="p-4 lg:p-6">
            <!-- Metrics Cards -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-6 lg:mb-8 mobile-grid-1 tablet-grid-2">
                <div class="metric-card text-white p-4 lg:p-6 rounded-xl card-hover mobile-p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-xs lg:text-sm opacity-90 mobile-text-xs">Investimento Total</p>
                            <p class="text-xl lg:text-2xl font-bold">R$ 45.280</p>
                            <p class="text-xs opacity-75 mt-1">+12% vs mês anterior</p>
                        </div>
                        <i class="fas fa-dollar-sign text-lg lg:text-2xl opacity-80"></i>
                    </div>
                </div>
                
                <div class="metric-card-2 text-white p-4 lg:p-6 rounded-xl card-hover mobile-p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-xs lg:text-sm opacity-90 mobile-text-xs">Campanhas Ativas</p>
                            <p class="text-xl lg:text-2xl font-bold">24</p>
                            <p class="text-xs opacity-75 mt-1">8 Google Ads, 16 Facebook</p>
                        </div>
                        <i class="fas fa-bullhorn text-lg lg:text-2xl opacity-80"></i>
                    </div>
                </div>
                
                <div class="metric-card-3 text-white p-4 lg:p-6 rounded-xl card-hover mobile-p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-xs lg:text-sm opacity-90 mobile-text-xs">Conversões</p>
                            <p class="text-xl lg:text-2xl font-bold">1.847</p>
                            <p class="text-xs opacity-75 mt-1">Taxa: 3.2%</p>
                        </div>
                        <i class="fas fa-chart-line text-lg lg:text-2xl opacity-80"></i>
                    </div>
                </div>
                
                <div class="metric-card-4 text-white p-4 lg:p-6 rounded-xl card-hover mobile-p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-xs lg:text-sm opacity-90 mobile-text-xs">ROAS Médio</p>
                            <p class="text-xl lg:text-2xl font-bold">4.2x</p>
                            <p class="text-xs opacity-75 mt-1">Retorno sobre investimento</p>
                        </div>
                        <i class="fas fa-trophy text-lg lg:text-2xl opacity-80"></i>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6 mb-6 lg:mb-8 mobile-grid-1 tablet-grid-1">
                <div class="bg-white p-4 lg:p-6 rounded-xl shadow-sm card-hover dark:bg-gray-900 dark:border dark:border-gray-700 mobile-p-4">
                    <h3 class="text-base lg:text-lg font-semibold mb-3 lg:mb-4 dark:text-white mobile-text-sm">Performance por Canal</h3>
                    <div class="relative h-48 lg:h-64 chart-container">
                        <canvas id="channelChart"></canvas>
                    </div>
                </div>
                
                <div class="bg-white p-4 lg:p-6 rounded-xl shadow-sm card-hover dark:bg-gray-900 dark:border dark:border-gray-700 mobile-p-4">
                    <h3 class="text-base lg:text-lg font-semibold mb-3 lg:mb-4 dark:text-white mobile-text-sm">Investimento vs Retorno</h3>
                    <div class="relative h-48 lg:h-64 chart-container">
                        <canvas id="roiChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Recent Campaigns -->
            <div class="bg-white rounded-xl shadow-sm card-hover dark:bg-gray-900 dark:border dark:border-gray-700">
                <div class="p-4 lg:p-6 border-b dark:border-gray-700 mobile-p-4">
                    <h3 class="text-base lg:text-lg font-semibold dark:text-white mobile-text-sm">Campanhas Recentes</h3>
                </div>
                <div class="overflow-x-auto table-responsive">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-800">
                            <tr>
                                <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-300">Campanha</th>
                                <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-300 mobile-hidden">Cliente</th>
                                <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-300">Canal</th>
                                <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-300">Investimento</th>
                                <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-300">ROAS</th>
                                <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-300">Status</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
                                <td class="px-3 lg:px-6 py-3 lg:py-4 font-medium dark:text-white text-xs lg:text-sm">Black Friday 2024</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4 dark:text-gray-300 text-xs lg:text-sm mobile-hidden">Loja Fashion</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4"><span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs dark:bg-gray-700 dark:text-white">Facebook</span></td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4 dark:text-gray-300 text-xs lg:text-sm">R$ 8.500</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4 font-semibold text-green-600 dark:text-green-400 text-xs lg:text-sm">5.2x</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs dark:bg-gray-700 dark:text-white">Ativa</span></td>
                            </tr>
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
                                <td class="px-3 lg:px-6 py-3 lg:py-4 font-medium dark:text-white text-xs lg:text-sm">Leads Qualificados</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4 dark:text-gray-300 text-xs lg:text-sm mobile-hidden">TechStart</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4"><span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs dark:bg-gray-700 dark:text-white">Google</span></td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4 dark:text-gray-300 text-xs lg:text-sm">R$ 3.200</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4 font-semibold text-green-600 dark:text-green-400 text-xs lg:text-sm">3.8x</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs dark:bg-gray-700 dark:text-white">Ativa</span></td>
                            </tr>
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
                                <td class="px-3 lg:px-6 py-3 lg:py-4 font-medium dark:text-white text-xs lg:text-sm">Remarketing Q4</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4 dark:text-gray-300 text-xs lg:text-sm mobile-hidden">E-commerce Plus</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4"><span class="bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs dark:bg-gray-700 dark:text-white">LinkedIn</span></td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4 dark:text-gray-300 text-xs lg:text-sm">R$ 1.800</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4 font-semibold text-yellow-600 dark:text-yellow-400 text-xs lg:text-sm">2.1x</td>
                                <td class="px-3 lg:px-6 py-3 lg:py-4"><span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs dark:bg-gray-700 dark:text-white">Pausada</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Clients Section -->
        <div id="clients-section" class="p-4 lg:p-6 hidden mobile-p-4">
            <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center mb-4 lg:mb-6 mobile-mb-4">
                <h3 class="text-lg lg:text-xl font-semibold mb-3 lg:mb-0 mobile-text-sm">Gestão de Clientes</h3>
                <div class="flex flex-col sm:flex-row items-stretch sm:items-center space-y-2 sm:space-y-0 sm:space-x-4 mobile-space-y-2">
                    <div class="relative">
                        <input 
                            type="text" 
                            id="clientSearch" 
                            placeholder="Buscar clientes..." 
                            class="pl-10 pr-4 py-2 border rounded-lg w-full sm:w-64 text-sm lg:text-base mobile-w-full"
                            onkeyup="searchClients()"
                        >
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400 text-sm lg:text-base"></i>
                    </div>
                </div>
            </div>
            <div class="flex flex-col sm:flex-row justify-end items-stretch sm:items-center mb-4 lg:mb-6 mobile-mb-4">
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 btn-group-responsive mobile-space-y-2">
                    <div class="relative">
                        <button onclick="toggleExportMenu('clients')" class="bg-green-600 text-white px-3 lg:px-4 py-2 rounded-lg hover:bg-green-700 flex items-center justify-center w-full sm:w-auto btn-responsive">
                            <i class="fas fa-download mr-1 lg:mr-2 text-sm lg:text-base"></i>
                            <span class="text-sm lg:text-base">Exportar</span>
                            <i class="fas fa-chevron-down ml-1 lg:ml-2 text-sm lg:text-base"></i>
                        </button>
                        <div id="clients-export-menu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-10 modal-responsive">
                            <button onclick="exportClients('excel')" class="w-full text-left px-4 py-2 hover:bg-gray-50 rounded-t-lg text-sm lg:text-base">
                                <i class="fas fa-file-excel text-green-600 mr-2"></i>Excel (.xlsx)
                            </button>
                            <button onclick="exportClients('csv')" class="w-full text-left px-4 py-2 hover:bg-gray-50 rounded-b-lg text-sm lg:text-base">
                                <i class="fas fa-file-csv text-blue-600 mr-2"></i>CSV (.csv)
                            </button>
                        </div>
                    </div>
                    <button onclick="openClientModal()" class="bg-blue-600 text-white px-3 lg:px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center w-full sm:w-auto btn-responsive">
                        <i class="fas fa-plus mr-1 lg:mr-2 text-sm lg:text-base"></i>
                        <span class="text-sm lg:text-base">Novo Cliente</span>
                    </button>
                </div>
            </div>
            
            <div id="clients-grid" class="flex flex-wrap gap-5">
                <!-- Clients will be rendered here dynamically -->
            </div>
        </div>

        <!-- Campaigns Section -->
        <div id="campaigns-section" class="p-6 hidden">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold">Gerenciamento de Campanhas</h3>
                <div class="flex space-x-3">
                    <div class="relative">
                        <button onclick="toggleExportMenu('campaigns')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center">
                            <i class="fas fa-download mr-2"></i>Exportar
                            <i class="fas fa-chevron-down ml-2"></i>
                        </button>
                        <div id="campaigns-export-menu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-10">
                            <button onclick="exportCampaigns('excel')" class="w-full text-left px-4 py-2 hover:bg-gray-50 rounded-t-lg">
                                <i class="fas fa-file-excel text-green-600 mr-2"></i>Excel (.xlsx)
                            </button>
                            <button onclick="exportCampaigns('csv')" class="w-full text-left px-4 py-2 hover:bg-gray-50 rounded-b-lg">
                                <i class="fas fa-file-csv text-blue-600 mr-2"></i>CSV (.csv)
                            </button>
                        </div>
                    </div>
                    <button onclick="openCampaignModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                        <i class="fas fa-plus mr-2"></i>Nova Campanha
                    </button>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-sm">
                <div class="p-6 border-b">
                    <div class="flex space-x-4">
                        <select id="clientFilter" class="border rounded-lg px-3 py-2" onchange="filterCampaigns()">
                            <option value="">Todos os Clientes</option>
                            <option value="Loja Fashion">Loja Fashion</option>
                            <option value="TechStart">TechStart</option>
                            <option value="E-commerce Plus">E-commerce Plus</option>
                        </select>
                        <select id="channelFilter" class="border rounded-lg px-3 py-2" onchange="filterCampaigns()">
                            <option value="">Todos os Canais</option>
                            <option value="Google">Google Ads</option>
                            <option value="Facebook">Facebook Ads</option>
                            <option value="LinkedIn">LinkedIn Ads</option>
                        </select>
                        <select id="statusFilter" class="border rounded-lg px-3 py-2" onchange="filterCampaigns()">
                            <option value="">Todos os Status</option>
                            <option value="Ativa">Ativa</option>
                            <option value="Pausada">Pausada</option>
                            <option value="Finalizada">Finalizada</option>
                        </select>
                        <button onclick="clearFilters()" class="bg-gray-100 text-gray-600 px-4 py-2 rounded-lg hover:bg-gray-200">
                            <i class="fas fa-times mr-1"></i>Limpar
                        </button>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Campanha</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Cliente</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Canal</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Orçamento</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Gasto</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Conversões</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ROAS</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ações</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 font-medium">Black Friday 2024</td>
                                <td class="px-6 py-4">Loja Fashion</td>
                                <td class="px-6 py-4"><span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs">Facebook</span></td>
                                <td class="px-6 py-4">R$ 10.000</td>
                                <td class="px-6 py-4">R$ 8.500</td>
                                <td class="px-6 py-4">342</td>
                                <td class="px-6 py-4 font-semibold text-green-600">5.2x</td>
                                <td class="px-6 py-4"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Ativa</span></td>
                                <td class="px-6 py-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-edit"></i></button>
                                    <button class="text-red-600 hover:text-red-800"><i class="fas fa-pause"></i></button>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 font-medium">Leads Qualificados</td>
                                <td class="px-6 py-4">TechStart</td>
                                <td class="px-6 py-4"><span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs">Google</span></td>
                                <td class="px-6 py-4">R$ 5.000</td>
                                <td class="px-6 py-4">R$ 3.200</td>
                                <td class="px-6 py-4">89</td>
                                <td class="px-6 py-4 font-semibold text-green-600">3.8x</td>
                                <td class="px-6 py-4"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Ativa</span></td>
                                <td class="px-6 py-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-edit"></i></button>
                                    <button class="text-red-600 hover:text-red-800"><i class="fas fa-pause"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Budget Section -->
        <div id="budget-section" class="p-6 hidden">
            <h3 class="text-xl font-semibold mb-6">Controle de Orçamento</h3>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm">
                    <h4 class="text-lg font-semibold mb-4">Distribuição de Orçamento</h4>
                    <div class="relative h-64">
                        <canvas id="budgetChart"></canvas>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h4 class="text-lg font-semibold mb-4">Resumo Financeiro</h4>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center p-3 bg-blue-50 rounded-lg">
                            <span class="text-sm font-medium">Orçamento Total</span>
                            <span class="font-bold text-blue-600">R$ 50.000</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-red-50 rounded-lg">
                            <span class="text-sm font-medium">Gasto Atual</span>
                            <span class="font-bold text-red-600">R$ 45.280</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-green-50 rounded-lg">
                            <span class="text-sm font-medium">Disponível</span>
                            <span class="font-bold text-green-600">R$ 4.720</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-purple-50 rounded-lg">
                            <span class="text-sm font-medium">Receita Gerada</span>
                            <span class="font-bold text-purple-600">R$ 190.176</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-sm">
                <div class="p-6 border-b">
                    <h4 class="text-lg font-semibold">Controle por Cliente</h4>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Cliente</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Orçamento</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Gasto</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">% Utilizado</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Receita</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ROAS</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 font-medium">Loja Fashion</td>
                                <td class="px-6 py-4">R$ 20.000</td>
                                <td class="px-6 py-4">R$ 15.200</td>
                                <td class="px-6 py-4">
                                    <div class="flex items-center">
                                        <div class="w-full bg-gray-200 rounded-full h-2 mr-2">
                                            <div class="bg-blue-600 h-2 rounded-full" style="width: 76%"></div>
                                        </div>
                                        <span class="text-sm">76%</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4">R$ 72.960</td>
                                <td class="px-6 py-4 font-semibold text-green-600">4.8x</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 font-medium">TechStart</td>
                                <td class="px-6 py-4">R$ 15.000</td>
                                <td class="px-6 py-4">R$ 8.900</td>
                                <td class="px-6 py-4">
                                    <div class="flex items-center">
                                        <div class="w-full bg-gray-200 rounded-full h-2 mr-2">
                                            <div class="bg-green-600 h-2 rounded-full" style="width: 59%"></div>
                                        </div>
                                        <span class="text-sm">59%</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4">R$ 28.480</td>
                                <td class="px-6 py-4 font-semibold text-green-600">3.2x</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Analytics Section -->
        <div id="analytics-section" class="p-6 hidden">
            <h3 class="text-xl font-semibold mb-6">Análises e Métricas</h3>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h4 class="text-lg font-semibold mb-4">Funil de Conversão</h4>
                    <div class="relative h-64">
                        <canvas id="funnelChart"></canvas>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h4 class="text-lg font-semibold mb-4">Performance Temporal</h4>
                    <div class="relative h-64">
                        <canvas id="timeChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h4 class="text-lg font-semibold mb-4">Métricas Principais</h4>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-sm">CTR Médio:</span>
                            <span class="font-semibold">2.8%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-sm">CPC Médio:</span>
                            <span class="font-semibold">R$ 1.45</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-sm">CPM Médio:</span>
                            <span class="font-semibold">R$ 12.30</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-sm">Taxa Conversão:</span>
                            <span class="font-semibold">3.2%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-sm">CPA Médio:</span>
                            <span class="font-semibold">R$ 24.50</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h4 class="text-lg font-semibold mb-4">Top Campanhas</h4>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm">Black Friday 2024</span>
                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">5.2x ROAS</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm">Leads Qualificados</span>
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs">3.8x ROAS</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm">Remarketing Q4</span>
                            <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">2.1x ROAS</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h4 class="text-lg font-semibold mb-4">Alertas</h4>
                    <div class="space-y-3">
                        <div class="flex items-center p-2 bg-red-50 rounded">
                            <i class="fas fa-exclamation-triangle text-red-500 mr-2"></i>
                            <span class="text-sm">Orçamento 90% utilizado</span>
                        </div>
                        <div class="flex items-center p-2 bg-yellow-50 rounded">
                            <i class="fas fa-info-circle text-yellow-500 mr-2"></i>
                            <span class="text-sm">CTR abaixo da média</span>
                        </div>
                        <div class="flex items-center p-2 bg-green-50 rounded">
                            <i class="fas fa-check-circle text-green-500 mr-2"></i>
                            <span class="text-sm">Meta de conversões atingida</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Section -->
        <div id="reports-section" class="p-6 hidden">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold">Relatórios Personalizados</h3>
                <button onclick="generateReport()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                    <i class="fas fa-file-export mr-2"></i>Gerar Relatório
                </button>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm">
                    <h4 class="text-lg font-semibold mb-4">Configurar Relatório</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Período</label>
                            <select class="w-full border rounded-lg px-3 py-2">
                                <option>Últimos 30 dias</option>
                                <option>Últimos 7 dias</option>
                                <option>Este mês</option>
                                <option>Mês anterior</option>
                                <option>Personalizado</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Cliente</label>
                            <select class="w-full border rounded-lg px-3 py-2">
                                <option>Todos os clientes</option>
                                <option>Loja Fashion</option>
                                <option>TechStart</option>
                                <option>E-commerce Plus</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Canal</label>
                            <select class="w-full border rounded-lg px-3 py-2">
                                <option>Todos os canais</option>
                                <option>Google Ads</option>
                                <option>Facebook Ads</option>
                                <option>LinkedIn Ads</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Formato</label>
                            <select class="w-full border rounded-lg px-3 py-2">
                                <option>PDF Executivo</option>
                                <option>Excel Detalhado</option>
                                <option>PowerPoint</option>
                                <option>Dashboard Online</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <label class="block text-sm font-medium mb-2">Métricas Incluídas</label>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                            <label class="flex items-center">
                                <input type="checkbox" checked class="mr-2">
                                <span class="text-sm">Investimento</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" checked class="mr-2">
                                <span class="text-sm">ROAS</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" checked class="mr-2">
                                <span class="text-sm">Conversões</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-2">
                                <span class="text-sm">CTR</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-2">
                                <span class="text-sm">CPC</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-2">
                                <span class="text-sm">Impressões</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h4 class="text-lg font-semibold mb-4">Relatórios Recentes</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 border rounded-lg">
                            <div>
                                <p class="font-medium text-sm">Relatório Mensal</p>
                                <p class="text-xs text-gray-500">15/11/2024</p>
                            </div>
                            <button class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                        <div class="flex items-center justify-between p-3 border rounded-lg">
                            <div>
                                <p class="font-medium text-sm">Performance Q4</p>
                                <p class="text-xs text-gray-500">01/11/2024</p>
                            </div>
                            <button class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                        <div class="flex items-center justify-between p-3 border rounded-lg">
                            <div>
                                <p class="font-medium text-sm">Black Friday</p>
                                <p class="text-xs text-gray-500">25/10/2024</p>
                            </div>
                            <button class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Integrations Section -->
        <div id="integrations-section" class="p-6 hidden">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold">Integrações com Plataformas</h3>
                <div class="flex space-x-3">
                    <button onclick="syncAllIntegrations()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center">
                        <i class="fas fa-sync-alt mr-2"></i>Sincronizar Todas
                    </button>
                    <button onclick="openAddIntegrationModal()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center">
                        <i class="fas fa-plus mr-2"></i>Nova Integração
                    </button>
                </div>
            </div>
            
            <!-- Integration Status Summary -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-green-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-green-600" id="connectedCount">2</div>
                    <div class="text-sm text-gray-600">Conectadas</div>
                </div>
                <div class="bg-yellow-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-yellow-600" id="pendingCount">1</div>
                    <div class="text-sm text-gray-600">Pendentes</div>
                </div>
                <div class="bg-red-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-red-600" id="errorCount">0</div>
                    <div class="text-sm text-gray-600">Com Erro</div>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600" id="lastSyncTime">Agora</div>
                    <div class="text-sm text-gray-600">Última Sync</div>
                </div>
            </div>
            
            <!-- Integration Cards -->
            <div id="integrations-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Cards will be rendered here dynamically -->
            </div>
            
            <!-- Integration Logs -->
            <div class="mt-8 bg-white rounded-xl shadow-sm">
                <div class="p-6 border-b">
                    <div class="flex justify-between items-center">
                        <h4 class="text-lg font-semibold">Log de Atividades</h4>
                        <button onclick="clearIntegrationLogs()" class="text-red-600 hover:text-red-800 text-sm">
                            <i class="fas fa-trash mr-1"></i>Limpar Logs
                        </button>
                    </div>
                </div>
                <div class="max-h-64 overflow-y-auto">
                    <div id="integration-logs" class="p-4 space-y-2">
                        <!-- Logs will be rendered here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Users Section -->
        <div id="users-section" class="p-6 hidden">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold">Controle de Usuários</h3>
                <button onclick="openUserModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                    <i class="fas fa-plus mr-2"></i>Novo Usuário
                </button>
            </div>
            
            <div class="bg-white rounded-xl shadow-sm">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Usuário</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Email</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Perfil</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Clientes</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Último Acesso</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ações</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4">
                                    <div class="flex items-center">
                                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%234F46E5'/%3E%3Ctext x='16' y='20' text-anchor='middle' fill='white' font-family='Arial' font-size='12' font-weight='bold'%3EJM%3C/text%3E%3C/svg%3E" alt="User" class="w-8 h-8 rounded-full mr-3">
                                        <span class="font-medium">João Manager</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4">joao@trafficpro.com</td>
                                <td class="px-6 py-4"><span class="bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs">Admin</span></td>
                                <td class="px-6 py-4">Todos</td>
                                <td class="px-6 py-4">Agora</td>
                                <td class="px-6 py-4"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Ativo</span></td>
                                <td class="px-6 py-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-edit"></i></button>
                                    <button class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4">
                                    <div class="flex items-center">
                                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%23EF4444'/%3E%3Ctext x='16' y='20' text-anchor='middle' fill='white' font-family='Arial' font-size='12' font-weight='bold'%3EMS%3C/text%3E%3C/svg%3E" alt="User" class="w-8 h-8 rounded-full mr-3">
                                        <span class="font-medium">Maria Silva</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4">maria@trafficpro.com</td>
                                <td class="px-6 py-4"><span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs">Gestor</span></td>
                                <td class="px-6 py-4">Loja Fashion, TechStart</td>
                                <td class="px-6 py-4">2 horas atrás</td>
                                <td class="px-6 py-4"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Ativo</span></td>
                                <td class="px-6 py-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-edit"></i></button>
                                    <button class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4">
                                    <div class="flex items-center">
                                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%2310B981'/%3E%3Ctext x='16' y='20' text-anchor='middle' fill='white' font-family='Arial' font-size='12' font-weight='bold'%3EPC%3C/text%3E%3C/svg%3E" alt="User" class="w-8 h-8 rounded-full mr-3">
                                        <span class="font-medium">Pedro Costa</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4">pedro@trafficpro.com</td>
                                <td class="px-6 py-4"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Analista</span></td>
                                <td class="px-6 py-4">E-commerce Plus</td>
                                <td class="px-6 py-4">1 dia atrás</td>
                                <td class="px-6 py-4"><span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs">Inativo</span></td>
                                <td class="px-6 py-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-edit"></i></button>
                                    <button class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Client Modal -->
    <div id="clientModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl p-4 lg:p-6 w-full max-w-md mx-auto modal-responsive">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-base lg:text-lg font-semibold mobile-text-sm">Novo Cliente</h3>
                <button onclick="closeClientModal()" class="text-gray-500 hover:text-gray-700 p-1">
                    <i class="fas fa-times text-sm lg:text-base"></i>
                </button>
            </div>
            <form class="space-y-3 lg:space-y-4 mobile-space-y-2" onsubmit="handleClientSubmit(event)">
                <div>
                    <label class="block text-xs lg:text-sm font-medium mb-1 mobile-text-xs">Nome da Empresa</label>
                    <input type="text" name="companyName" class="w-full border rounded-lg px-3 py-2 text-sm lg:text-base mobile-py-2" placeholder="Ex: Loja Fashion" required>
                </div>
                <div>
                    <label class="block text-xs lg:text-sm font-medium mb-1 mobile-text-xs">Segmento</label>
                    <select name="segment" class="w-full border rounded-lg px-3 py-2 text-sm lg:text-base mobile-py-2" required>
                        <option value="E-commerce">E-commerce</option>
                        <option value="Serviços">Serviços</option>
                        <option value="SaaS">SaaS</option>
                        <option value="Educação">Educação</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>
                <div>
                    <label class="block text-xs lg:text-sm font-medium mb-1 mobile-text-xs">Orçamento Mensal</label>
                    <input type="text" name="budget" class="w-full border rounded-lg px-3 py-2 text-sm lg:text-base mobile-py-2" placeholder="R$ 10.000" required>
                </div>
                <div>
                    <label class="block text-xs lg:text-sm font-medium mb-1 mobile-text-xs">Contato Principal</label>
                    <input type="email" name="contact" class="w-full border rounded-lg px-3 py-2 text-sm lg:text-base mobile-py-2" placeholder="contato@empresa.com" required>
                </div>
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 pt-3 lg:pt-4 btn-group-responsive mobile-space-y-2">
                    <button type="button" onclick="closeClientModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg text-sm lg:text-base btn-responsive">Fechar</button>
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 rounded-lg text-sm lg:text-base btn-responsive">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Campaign Modal -->
    <div id="campaignModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-full max-w-lg mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Nova Campanha</h3>
                <button onclick="closeCampaignModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="space-y-4" onsubmit="handleCampaignSubmit(event)">
                <div>
                    <label class="block text-sm font-medium mb-1">Nome da Campanha</label>
                    <input type="text" name="campaignName" class="w-full border rounded-lg px-3 py-2" placeholder="Ex: Black Friday 2024" required>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Cliente</label>
                        <select name="client" class="w-full border rounded-lg px-3 py-2" required>
                            <option value="Loja Fashion">Loja Fashion</option>
                            <option value="TechStart">TechStart</option>
                            <option value="E-commerce Plus">E-commerce Plus</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Canal</label>
                        <select name="channel" class="w-full border rounded-lg px-3 py-2" required>
                            <option value="Facebook">Facebook Ads</option>
                            <option value="Google">Google Ads</option>
                            <option value="LinkedIn">LinkedIn Ads</option>
                        </select>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Orçamento</label>
                        <input type="text" name="budget" class="w-full border rounded-lg px-3 py-2" placeholder="R$ 5.000" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Objetivo</label>
                        <select name="objective" class="w-full border rounded-lg px-3 py-2" required>
                            <option value="Conversões">Conversões</option>
                            <option value="Tráfego">Tráfego</option>
                            <option value="Reconhecimento">Reconhecimento</option>
                            <option value="Leads">Leads</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Público-Alvo</label>
                    <textarea name="audience" class="w-full border rounded-lg px-3 py-2" rows="3" placeholder="Descreva o público-alvo da campanha..." required></textarea>
                </div>
                <div class="flex space-x-3 pt-4">
                    <button type="button" onclick="closeCampaignModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg">Fechar</button>
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 rounded-lg">Criar Campanha</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Client Modal -->
    <div id="editClientModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-full max-w-md mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Editar Cliente</h3>
                <button onclick="closeEditClientModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="space-y-4" onsubmit="handleEditClientSubmit(event)">
                <input type="hidden" name="clientId" id="editClientId">
                <div>
                    <label class="block text-sm font-medium mb-1">Nome da Empresa</label>
                    <input type="text" name="companyName" id="editCompanyName" class="w-full border rounded-lg px-3 py-2" placeholder="Ex: Loja Fashion" required>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Segmento</label>
                    <select name="segment" id="editSegment" class="w-full border rounded-lg px-3 py-2" required>
                        <option value="E-commerce">E-commerce</option>
                        <option value="Serviços">Serviços</option>
                        <option value="SaaS">SaaS</option>
                        <option value="Educação">Educação</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Orçamento Mensal</label>
                    <input type="text" name="budget" id="editBudget" class="w-full border rounded-lg px-3 py-2" placeholder="R$ 10.000" required>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Contato Principal</label>
                    <input type="email" name="contact" id="editContact" class="w-full border rounded-lg px-3 py-2" placeholder="contato@empresa.com" required>
                </div>
                <div class="flex space-x-3 pt-4">
                    <button type="button" onclick="closeEditClientModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg">Fechar</button>
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 rounded-lg">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Client Report Modal -->
    <div id="clientReportModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold">Relatório do Cliente</h3>
                <button onclick="closeClientReportModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="clientReportContent">
                <!-- Content will be populated dynamically -->
            </div>
        </div>
    </div>

    <!-- Edit Campaign Modal -->
    <div id="editCampaignModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-full max-w-lg mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Editar Campanha</h3>
                <button onclick="closeEditCampaignModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="space-y-4" onsubmit="handleEditCampaignSubmit(event)">
                <input type="hidden" name="campaignId" id="editCampaignId">
                <div>
                    <label class="block text-sm font-medium mb-1">Nome da Campanha</label>
                    <input type="text" name="campaignName" id="editCampaignName" class="w-full border rounded-lg px-3 py-2" placeholder="Ex: Black Friday 2024" required>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Cliente</label>
                        <select name="client" id="editCampaignClient" class="w-full border rounded-lg px-3 py-2" required>
                            <option value="Loja Fashion">Loja Fashion</option>
                            <option value="TechStart">TechStart</option>
                            <option value="E-commerce Plus">E-commerce Plus</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Canal</label>
                        <select name="channel" id="editCampaignChannel" class="w-full border rounded-lg px-3 py-2" required>
                            <option value="Facebook">Facebook Ads</option>
                            <option value="Google">Google Ads</option>
                            <option value="LinkedIn">LinkedIn Ads</option>
                        </select>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Orçamento</label>
                        <input type="text" name="budget" id="editCampaignBudget" class="w-full border rounded-lg px-3 py-2" placeholder="R$ 5.000" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Status</label>
                        <select name="status" id="editCampaignStatus" class="w-full border rounded-lg px-3 py-2" required>
                            <option value="Ativa">Ativa</option>
                            <option value="Pausada">Pausada</option>
                            <option value="Cancelada">Cancelada</option>
                            <option value="Finalizada">Finalizada</option>
                        </select>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Valor Gasto</label>
                        <input type="text" name="spent" id="editCampaignSpent" class="w-full border rounded-lg px-3 py-2" placeholder="R$ 3.000">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Conversões</label>
                        <input type="number" name="conversions" id="editCampaignConversions" class="w-full border rounded-lg px-3 py-2" placeholder="150">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">ROAS</label>
                    <input type="number" step="0.1" name="roas" id="editCampaignRoas" class="w-full border rounded-lg px-3 py-2" placeholder="3.5">
                </div>
                <div class="flex space-x-3 pt-4">
                    <button type="button" onclick="closeEditCampaignModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg">Fechar</button>
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 rounded-lg">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-full max-w-md mx-4">
            <div class="flex items-center mb-4">
                <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mr-4">
                    <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-gray-900">Confirmar Exclusão</h3>
                    <p class="text-sm text-gray-500">Esta ação não pode ser desfeita</p>
                </div>
            </div>
            <p id="confirmMessage" class="text-gray-700 mb-6"></p>
            <div class="flex space-x-3">
                <button onclick="closeConfirmModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg hover:bg-gray-300">
                    Não, Manter
                </button>
                <button id="confirmButton" class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700">
                    Sim, Confirmar
                </button>
            </div>
        </div>
    </div>

    <!-- User Modal -->
    <div id="userModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-full max-w-md mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Novo Usuário</h3>
                <button onclick="closeUserModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-1">Nome Completo</label>
                    <input type="text" class="w-full border rounded-lg px-3 py-2" placeholder="Ex: João Silva">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Email</label>
                    <input type="email" class="w-full border rounded-lg px-3 py-2" placeholder="joao@empresa.com">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Perfil de Acesso</label>
                    <select class="w-full border rounded-lg px-3 py-2">
                        <option>Analista</option>
                        <option>Gestor</option>
                        <option>Admin</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Clientes Permitidos</label>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2">
                            <span class="text-sm">Loja Fashion</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2">
                            <span class="text-sm">TechStart</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2">
                            <span class="text-sm">E-commerce Plus</span>
                        </label>
                    </div>
                </div>
                <div class="flex space-x-3 pt-4">
                    <button type="button" onclick="closeUserModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg">Fechar</button>
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 rounded-lg">Criar Usuário</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Integration Modal -->
    <div id="addIntegrationModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-full max-w-lg mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Nova Integração</h3>
                <button onclick="closeAddIntegrationModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="space-y-4" onsubmit="handleAddIntegration(event)">
                <div>
                    <label class="block text-sm font-medium mb-1">Plataforma</label>
                    <select name="platform" id="integrationPlatform" class="w-full border rounded-lg px-3 py-2" onchange="updateIntegrationForm()" required>
                        <option value="">Selecione uma plataforma</option>
                        <option value="google-ads">Google Ads</option>
                        <option value="facebook-ads">Facebook Ads</option>
                        <option value="linkedin-ads">LinkedIn Ads</option>
                        <option value="google-analytics">Google Analytics</option>
                        <option value="shopify">Shopify</option>
                        <option value="webhook">Webhook Personalizado</option>
                        <option value="tiktok-ads">TikTok Ads</option>
                        <option value="twitter-ads">Twitter Ads</option>
                    </select>
                </div>
                
                <div id="integration-form-fields">
                    <!-- Dynamic fields will be inserted here -->
                </div>
                
                <div class="flex space-x-3 pt-4">
                    <button type="button" onclick="closeAddIntegrationModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg">Cancelar</button>
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 rounded-lg">Conectar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Integration Config Modal -->
    <div id="integrationConfigModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold" id="configModalTitle">Configurar Integração</h3>
                <button onclick="closeIntegrationConfigModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="integration-config-content">
                <!-- Content will be populated dynamically -->
            </div>
        </div>
    </div>

    <!-- Integration Test Modal -->
    <div id="integrationTestModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-full max-w-lg mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Testar Integração</h3>
                <button onclick="closeIntegrationTestModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="integration-test-content">
                <div class="text-center py-8">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                    <p class="text-gray-600">Testando conexão...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Credentials Modal -->
    <div id="editCredentialsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-full max-w-lg mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold" id="editCredentialsTitle">Editar Credenciais</h3>
                <button onclick="closeEditCredentialsModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="space-y-4" onsubmit="handleEditCredentials(event)">
                <input type="hidden" name="integrationId" id="editIntegrationId">
                
                <div class="bg-yellow-50 p-4 rounded-lg mb-4">
                    <div class="flex items-center">
                        <i class="fas fa-shield-alt text-yellow-600 mr-3"></i>
                        <div>
                            <div class="font-medium text-yellow-800">Segurança das Credenciais</div>
                            <div class="text-sm text-yellow-700">Suas credenciais são armazenadas de forma segura e criptografada.</div>
                        </div>
                    </div>
                </div>
                
                <div id="edit-credentials-fields">
                    <!-- Dynamic fields will be inserted here -->
                </div>
                
                <div class="flex space-x-3 pt-4">
                    <button type="button" onclick="closeEditCredentialsModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg hover:bg-gray-300">
                        Cancelar
                    </button>
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">
                        <i class="fas fa-save mr-2"></i>Salvar Alterações
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let filteredCampaigns = [];
        let filteredClients = [];

        // Integration system variables
        let integrations = JSON.parse(localStorage.getItem('trafficpro_integrations')) || [
            {
                id: 1,
                platform: 'google-ads',
                name: 'Google Ads',
                status: 'connected',
                icon: 'fab fa-google',
                color: 'blue-600',
                apiVersion: 'v13',
                description: 'Sincronização automática de campanhas, métricas e orçamentos.',
                credentials: {
                    clientId: 'demo_client_id',
                    clientSecret: '***hidden***',
                    refreshToken: '***hidden***'
                },
                lastSync: new Date().toISOString(),
                syncInterval: 3600000, // 1 hour
                dataImported: {
                    campaigns: 15,
                    keywords: 1250,
                    ads: 45
                },
                settings: {
                    autoSync: true,
                    importCampaigns: true,
                    importKeywords: true,
                    importAds: true
                }
            },
            {
                id: 2,
                platform: 'facebook-ads',
                name: 'Facebook Ads',
                status: 'connected',
                icon: 'fab fa-facebook',
                color: 'blue-800',
                apiVersion: 'Marketing API v18',
                description: 'Gestão completa de campanhas no Facebook e Instagram.',
                credentials: {
                    accessToken: '***hidden***',
                    appId: 'demo_app_id',
                    appSecret: '***hidden***'
                },
                lastSync: new Date(Date.now() - 1800000).toISOString(), // 30 min ago
                syncInterval: 1800000, // 30 minutes
                dataImported: {
                    campaigns: 8,
                    adSets: 24,
                    ads: 72
                },
                settings: {
                    autoSync: true,
                    importCampaigns: true,
                    importAdSets: true,
                    importAds: true
                }
            },
            {
                id: 3,
                platform: 'linkedin-ads',
                name: 'LinkedIn Ads',
                status: 'pending',
                icon: 'fab fa-linkedin',
                color: 'blue-700',
                apiVersion: 'Campaign Manager',
                description: 'Campanhas B2B e segmentação profissional avançada.',
                credentials: {},
                lastSync: null,
                syncInterval: 7200000, // 2 hours
                dataImported: {},
                settings: {
                    autoSync: false,
                    importCampaigns: true,
                    importSponsored: true
                }
            }
        ];

        let integrationLogs = JSON.parse(localStorage.getItem('trafficpro_integration_logs')) || [
            {
                id: 1,
                timestamp: new Date().toISOString(),
                platform: 'Google Ads',
                action: 'Sincronização automática',
                status: 'success',
                message: '15 campanhas sincronizadas com sucesso',
                details: 'Importados: 15 campanhas, 1250 palavras-chave, 45 anúncios'
            },
            {
                id: 2,
                timestamp: new Date(Date.now() - 1800000).toISOString(),
                platform: 'Facebook Ads',
                action: 'Sincronização automática',
                status: 'success',
                message: '8 campanhas sincronizadas com sucesso',
                details: 'Importados: 8 campanhas, 24 conjuntos de anúncios, 72 anúncios'
            }
        ];

        // Data storage with localStorage
        let campaigns = JSON.parse(localStorage.getItem('trafficpro_campaigns')) || [
            {
                id: 1,
                name: 'Black Friday 2024',
                client: 'Loja Fashion',
                channel: 'Facebook',
                budget: 10000,
                spent: 8500,
                conversions: 342,
                roas: 5.2,
                status: 'Ativa',
                createdAt: new Date().toISOString()
            },
            {
                id: 2,
                name: 'Leads Qualificados',
                client: 'TechStart',
                channel: 'Google',
                budget: 5000,
                spent: 3200,
                conversions: 89,
                roas: 3.8,
                status: 'Ativa',
                createdAt: new Date().toISOString()
            },
            {
                id: 3,
                name: 'Remarketing Q4',
                client: 'E-commerce Plus',
                channel: 'LinkedIn',
                budget: 3000,
                spent: 1800,
                conversions: 23,
                roas: 2.1,
                status: 'Pausada',
                createdAt: new Date().toISOString()
            },
            {
                id: 4,
                name: 'Campanha Natal 2023',
                client: 'Loja Fashion',
                channel: 'Facebook',
                budget: 8000,
                spent: 7800,
                conversions: 156,
                roas: 4.1,
                status: 'Finalizada',
                createdAt: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString()
            }
        ];

        let clients = JSON.parse(localStorage.getItem('trafficpro_clients')) || [
            { id: 1, name: 'Loja Fashion', segment: 'E-commerce', budget: 20000, contact: 'contato@lojafashion.com', createdAt: new Date().toISOString() },
            { id: 2, name: 'TechStart', segment: 'SaaS', budget: 15000, contact: 'contato@techstart.com', createdAt: new Date().toISOString() },
            { id: 3, name: 'E-commerce Plus', segment: 'E-commerce', budget: 10000, contact: 'contato@ecommerceplus.com', createdAt: new Date().toISOString() }
        ];

        // Save data to localStorage
        function saveToStorage() {
            localStorage.setItem('trafficpro_campaigns', JSON.stringify(campaigns));
            localStorage.setItem('trafficpro_clients', JSON.stringify(clients));
            localStorage.setItem('trafficpro_integrations', JSON.stringify(integrations));
            localStorage.setItem('trafficpro_integration_logs', JSON.stringify(integrationLogs));
        }

        // Integration Functions
        function renderIntegrationsGrid() {
            const grid = document.getElementById('integrations-grid');
            if (!grid) return;
            
            grid.innerHTML = integrations.map(integration => {
                const statusColor = integration.status === 'connected' ? 'green' : 
                                  integration.status === 'configured' ? 'blue' :
                                  integration.status === 'pending' ? 'yellow' : 
                                  integration.status === 'error' ? 'red' : 'gray';
                
                const statusText = integration.status === 'connected' ? 'Conectado' : 
                                 integration.status === 'configured' ? 'Configurado' :
                                 integration.status === 'pending' ? 'Pendente' : 
                                 integration.status === 'error' ? 'Erro' : 'Desconectado';
                
                const lastSyncText = integration.lastSync ? 
                    new Date(integration.lastSync).toLocaleString('pt-BR') : 'Nunca';
                
                return `
                    <div class="bg-white p-6 rounded-xl shadow-sm card-hover dark:bg-gray-900 dark:border dark:border-gray-700">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-${integration.color} rounded-lg flex items-center justify-center">
                                    <i class="${integration.icon} text-white"></i>
                                </div>
                                <div class="ml-3">
                                    <h4 class="font-semibold dark:text-white">${integration.name}</h4>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${integration.apiVersion}</p>
                                </div>
                            </div>
                            <span class="bg-${statusColor}-100 text-${statusColor}-800 px-2 py-1 rounded-full text-xs dark:bg-gray-700 dark:text-white">
                                ${statusText}
                            </span>
                        </div>
                        
                        <p class="text-sm text-gray-600 dark:text-gray-300 mb-4">${integration.description}</p>
                        
                        ${integration.status === 'connected' ? `
                            <div class="mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                <div class="text-xs text-gray-500 dark:text-gray-400 mb-2">Dados Importados:</div>
                                <div class="grid grid-cols-3 gap-2 text-xs">
                                    ${Object.entries(integration.dataImported).map(([key, value]) => `
                                        <div class="text-center">
                                            <div class="font-semibold dark:text-white">${value}</div>
                                            <div class="text-gray-500 dark:text-gray-400">${key}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="text-xs text-gray-500 dark:text-gray-400 mb-4">
                                Última sync: ${lastSyncText}
                            </div>
                        ` : ''}
                        
                        <div class="flex space-x-2">
                            ${integration.status === 'connected' ? `
                                <button onclick="configureIntegration(${integration.id})" class="flex-1 bg-blue-50 text-blue-600 py-2 rounded-lg text-sm hover:bg-blue-100 dark:bg-gray-700 dark:text-white">
                                    Configurar
                                </button>
                                <button onclick="testIntegration(${integration.id})" class="flex-1 bg-gray-50 text-gray-600 py-2 rounded-lg text-sm hover:bg-gray-100 dark:bg-gray-700 dark:text-white">
                                    Testar
                                </button>
                                <button onclick="syncIntegration(${integration.id})" class="bg-green-50 text-green-600 px-3 py-2 rounded-lg text-sm hover:bg-green-100 dark:bg-gray-700 dark:text-white">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                                <button onclick="editCredentials(${integration.id})" class="bg-yellow-50 text-yellow-600 px-3 py-2 rounded-lg text-sm hover:bg-yellow-100 dark:bg-gray-700 dark:text-white" title="Editar Credenciais">
                                    <i class="fas fa-key"></i>
                                </button>
                                <button onclick="disconnectIntegration(${integration.id})" class="bg-red-50 text-red-600 px-3 py-2 rounded-lg text-sm hover:bg-red-100 dark:bg-gray-700 dark:text-white">
                                    <i class="fas fa-unlink"></i>
                                </button>
                            ` : integration.status === 'configured' ? `
                                <button onclick="connectIntegration(${integration.id})" class="flex-1 bg-green-50 text-green-600 py-2 rounded-lg text-sm hover:bg-green-100 dark:bg-gray-700 dark:text-white">
                                    <i class="fas fa-plug mr-1"></i>Conectar
                                </button>
                                <button onclick="testIntegration(${integration.id})" class="flex-1 bg-blue-50 text-blue-600 py-2 rounded-lg text-sm hover:bg-blue-100 dark:bg-gray-700 dark:text-white">
                                    <i class="fas fa-vial mr-1"></i>Testar
                                </button>
                                <button onclick="editCredentials(${integration.id})" class="bg-yellow-50 text-yellow-600 px-3 py-2 rounded-lg text-sm hover:bg-yellow-100 dark:bg-gray-700 dark:text-white" title="Editar Credenciais">
                                    <i class="fas fa-key"></i>
                                </button>
                                <button onclick="deleteIntegration(${integration.id})" class="bg-red-50 text-red-600 px-3 py-2 rounded-lg text-sm hover:bg-red-100 dark:bg-gray-700 dark:text-white">
                                    <i class="fas fa-trash"></i>
                                </button>
                            ` : integration.status === 'pending' ? `
                                <button onclick="connectIntegration(${integration.id})" class="flex-1 bg-blue-50 text-blue-600 py-2 rounded-lg text-sm hover:bg-blue-100 dark:bg-gray-700 dark:text-white">
                                    Conectar
                                </button>
                                <button onclick="deleteIntegration(${integration.id})" class="flex-1 bg-red-50 text-red-600 py-2 rounded-lg text-sm hover:bg-red-100 dark:bg-gray-700 dark:text-white">
                                    Remover
                                </button>
                            ` : `
                                <button onclick="connectIntegration(${integration.id})" class="flex-1 bg-blue-50 text-blue-600 py-2 rounded-lg text-sm hover:bg-blue-100 dark:bg-gray-700 dark:text-white">
                                    Reconectar
                                </button>
                                <button onclick="editCredentials(${integration.id})" class="bg-yellow-50 text-yellow-600 px-3 py-2 rounded-lg text-sm hover:bg-yellow-100 dark:bg-gray-700 dark:text-white" title="Editar Credenciais">
                                    <i class="fas fa-key"></i>
                                </button>
                                <button onclick="deleteIntegration(${integration.id})" class="flex-1 bg-red-50 text-red-600 py-2 rounded-lg text-sm hover:bg-red-100 dark:bg-gray-700 dark:text-white">
                                    Remover
                                </button>
                            `}
                        </div>
                    </div>
                `;
            }).join('');
            
            updateIntegrationStats();
        }

        function updateIntegrationStats() {
            const connected = integrations.filter(i => i.status === 'connected').length;
            const configured = integrations.filter(i => i.status === 'configured').length;
            const pending = integrations.filter(i => i.status === 'pending').length;
            const error = integrations.filter(i => i.status === 'error').length;
            const lastSync = integrations
                .filter(i => i.lastSync)
                .sort((a, b) => new Date(b.lastSync) - new Date(a.lastSync))[0];
            
            document.getElementById('connectedCount').textContent = connected;
            document.getElementById('pendingCount').textContent = configured + pending;
            document.getElementById('errorCount').textContent = error;
            document.getElementById('lastSyncTime').textContent = lastSync ? 
                new Date(lastSync.lastSync).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' }) : 'Nunca';
        }

        function renderIntegrationLogs() {
            const logsContainer = document.getElementById('integration-logs');
            if (!logsContainer) return;
            
            const sortedLogs = integrationLogs
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                .slice(0, 20); // Show last 20 logs
            
            logsContainer.innerHTML = sortedLogs.map(log => {
                const statusIcon = log.status === 'success' ? 'fa-check-circle text-green-500' : 
                                 log.status === 'error' ? 'fa-exclamation-circle text-red-500' : 
                                 'fa-info-circle text-blue-500';
                
                return `
                    <div class="flex items-start space-x-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg">
                        <i class="fas ${statusIcon} mt-1"></i>
                        <div class="flex-1">
                            <div class="flex justify-between items-start">
                                <div>
                                    <div class="font-medium text-sm dark:text-white">${log.platform} - ${log.action}</div>
                                    <div class="text-sm text-gray-600 dark:text-gray-300">${log.message}</div>
                                    ${log.details ? `<div class="text-xs text-gray-500 dark:text-gray-400 mt-1">${log.details}</div>` : ''}
                                </div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">
                                    ${new Date(log.timestamp).toLocaleString('pt-BR')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function addIntegrationLog(platform, action, status, message, details = '') {
            const newLog = {
                id: integrationLogs.length > 0 ? Math.max(...integrationLogs.map(l => l.id)) + 1 : 1,
                timestamp: new Date().toISOString(),
                platform,
                action,
                status,
                message,
                details
            };
            
            integrationLogs.unshift(newLog);
            
            // Keep only last 100 logs
            if (integrationLogs.length > 100) {
                integrationLogs = integrationLogs.slice(0, 100);
            }
            
            saveToStorage();
            renderIntegrationLogs();
        }

        // Integration Modal Functions
        function openAddIntegrationModal() {
            document.getElementById('addIntegrationModal').classList.remove('hidden');
        }

        function closeAddIntegrationModal() {
            document.getElementById('addIntegrationModal').classList.add('hidden');
            document.getElementById('addIntegrationModal').querySelector('form').reset();
            document.getElementById('integration-form-fields').innerHTML = '';
        }

        function updateIntegrationForm() {
            const platform = document.getElementById('integrationPlatform').value;
            const fieldsContainer = document.getElementById('integration-form-fields');
            
            if (!platform) {
                fieldsContainer.innerHTML = '';
                return;
            }
            
            const platformConfigs = {
                'google-ads': {
                    fields: [
                        { name: 'clientId', label: 'Client ID', type: 'text', placeholder: 'Seu Google Ads Client ID', required: true },
                        { name: 'clientSecret', label: 'Client Secret', type: 'password', placeholder: 'Seu Client Secret', required: true },
                        { name: 'refreshToken', label: 'Refresh Token', type: 'password', placeholder: 'Token de atualização', required: true },
                        { name: 'customerId', label: 'Customer ID', type: 'text', placeholder: 'ID da conta (ex: 123-456-7890)', required: true }
                    ]
                },
                'facebook-ads': {
                    fields: [
                        { name: 'accessToken', label: 'Access Token', type: 'password', placeholder: 'Token de acesso do Facebook', required: true },
                        { name: 'appId', label: 'App ID', type: 'text', placeholder: 'ID da aplicação Facebook', required: true },
                        { name: 'appSecret', label: 'App Secret', type: 'password', placeholder: 'Secret da aplicação', required: true },
                        { name: 'adAccountId', label: 'Ad Account ID', type: 'text', placeholder: 'ID da conta de anúncios', required: true }
                    ]
                },
                'linkedin-ads': {
                    fields: [
                        { name: 'clientId', label: 'Client ID', type: 'text', placeholder: 'LinkedIn Client ID', required: true },
                        { name: 'clientSecret', label: 'Client Secret', type: 'password', placeholder: 'LinkedIn Client Secret', required: true },
                        { name: 'accessToken', label: 'Access Token', type: 'password', placeholder: 'Token de acesso', required: true },
                        { name: 'adAccountId', label: 'Ad Account ID', type: 'text', placeholder: 'ID da conta de anúncios', required: true }
                    ]
                },
                'google-analytics': {
                    fields: [
                        { name: 'trackingId', label: 'Tracking ID', type: 'text', placeholder: 'GA4 Measurement ID (G-XXXXXXXXXX)', required: true },
                        { name: 'serviceAccountKey', label: 'Service Account Key', type: 'textarea', placeholder: 'JSON da chave da conta de serviço', required: true },
                        { name: 'propertyId', label: 'Property ID', type: 'text', placeholder: 'ID da propriedade GA4', required: true }
                    ]
                },
                'shopify': {
                    fields: [
                        { name: 'shopDomain', label: 'Domínio da Loja', type: 'text', placeholder: 'minhaloja.myshopify.com', required: true },
                        { name: 'accessToken', label: 'Access Token', type: 'password', placeholder: 'Token de acesso privado', required: true },
                        { name: 'apiKey', label: 'API Key', type: 'text', placeholder: 'Chave da API', required: true },
                        { name: 'apiSecret', label: 'API Secret', type: 'password', placeholder: 'Secret da API', required: true }
                    ]
                },
                'webhook': {
                    fields: [
                        { name: 'webhookUrl', label: 'URL do Webhook', type: 'url', placeholder: 'https://api.exemplo.com/webhook', required: true },
                        { name: 'secretKey', label: 'Chave Secreta', type: 'password', placeholder: 'Chave para validação', required: false },
                        { name: 'method', label: 'Método HTTP', type: 'select', options: ['POST', 'PUT', 'PATCH'], required: true },
                        { name: 'headers', label: 'Headers Personalizados', type: 'textarea', placeholder: 'JSON com headers adicionais', required: false }
                    ]
                },
                'tiktok-ads': {
                    fields: [
                        { name: 'appId', label: 'App ID', type: 'text', placeholder: 'TikTok App ID', required: true },
                        { name: 'secret', label: 'Secret', type: 'password', placeholder: 'TikTok App Secret', required: true },
                        { name: 'accessToken', label: 'Access Token', type: 'password', placeholder: 'Token de acesso', required: true },
                        { name: 'advertiserId', label: 'Advertiser ID', type: 'text', placeholder: 'ID do anunciante', required: true }
                    ]
                },
                'twitter-ads': {
                    fields: [
                        { name: 'consumerKey', label: 'Consumer Key', type: 'text', placeholder: 'Twitter Consumer Key', required: true },
                        { name: 'consumerSecret', label: 'Consumer Secret', type: 'password', placeholder: 'Twitter Consumer Secret', required: true },
                        { name: 'accessToken', label: 'Access Token', type: 'password', placeholder: 'Token de acesso', required: true },
                        { name: 'accessTokenSecret', label: 'Access Token Secret', type: 'password', placeholder: 'Secret do token', required: true }
                    ]
                }
            };
            
            const config = platformConfigs[platform];
            if (!config) return;
            
            fieldsContainer.innerHTML = config.fields.map(field => {
                if (field.type === 'select') {
                    return `
                        <div>
                            <label class="block text-sm font-medium mb-1">${field.label}</label>
                            <select name="${field.name}" class="w-full border rounded-lg px-3 py-2" ${field.required ? 'required' : ''}>
                                ${field.options.map(option => `<option value="${option}">${option}</option>`).join('')}
                            </select>
                        </div>
                    `;
                } else if (field.type === 'textarea') {
                    return `
                        <div>
                            <label class="block text-sm font-medium mb-1">${field.label}</label>
                            <textarea name="${field.name}" class="w-full border rounded-lg px-3 py-2" rows="3" placeholder="${field.placeholder}" ${field.required ? 'required' : ''}></textarea>
                        </div>
                    `;
                } else {
                    return `
                        <div>
                            <label class="block text-sm font-medium mb-1">${field.label}</label>
                            <input type="${field.type}" name="${field.name}" class="w-full border rounded-lg px-3 py-2" placeholder="${field.placeholder}" ${field.required ? 'required' : ''}>
                        </div>
                    `;
                }
            }).join('');
        }

        function handleAddIntegration(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const platform = formData.get('platform');
            
            const platformNames = {
                'google-ads': 'Google Ads',
                'facebook-ads': 'Facebook Ads',
                'linkedin-ads': 'LinkedIn Ads',
                'google-analytics': 'Google Analytics',
                'shopify': 'Shopify',
                'webhook': 'Webhook Personalizado',
                'tiktok-ads': 'TikTok Ads',
                'twitter-ads': 'Twitter Ads'
            };
            
            const platformIcons = {
                'google-ads': 'fab fa-google',
                'facebook-ads': 'fab fa-facebook',
                'linkedin-ads': 'fab fa-linkedin',
                'google-analytics': 'fas fa-chart-line',
                'shopify': 'fas fa-shopping-cart',
                'webhook': 'fas fa-code',
                'tiktok-ads': 'fab fa-tiktok',
                'twitter-ads': 'fab fa-twitter'
            };
            
            const platformColors = {
                'google-ads': 'blue-600',
                'facebook-ads': 'blue-800',
                'linkedin-ads': 'blue-700',
                'google-analytics': 'orange-600',
                'shopify': 'purple-600',
                'webhook': 'green-600',
                'tiktok-ads': 'black',
                'twitter-ads': 'blue-400'
            };
            
            // Collect and validate credentials
            const credentials = {};
            let hasValidCredentials = false;
            
            for (let [key, value] of formData.entries()) {
                if (key !== 'platform' && value.trim()) {
                    credentials[key] = value.trim();
                    hasValidCredentials = true;
                }
            }
            
            if (!hasValidCredentials) {
                showErrorMessage('Por favor, preencha pelo menos uma credencial para continuar.');
                return;
            }
            
            // Validate required fields based on platform
            const requiredFields = getRequiredFieldsForPlatform(platform);
            const missingFields = requiredFields.filter(field => !credentials[field]);
            
            if (missingFields.length > 0) {
                showErrorMessage(`Campos obrigatórios não preenchidos: ${missingFields.join(', ')}`);
                return;
            }
            
            const newIntegration = {
                id: integrations.length > 0 ? Math.max(...integrations.map(i => i.id)) + 1 : 1,
                platform: platform,
                name: platformNames[platform],
                status: 'configured', // New status for configured but not connected
                icon: platformIcons[platform],
                color: platformColors[platform],
                apiVersion: getApiVersionForPlatform(platform),
                description: `Integração com ${platformNames[platform]} configurada com suas credenciais.`,
                credentials: credentials,
                lastSync: null,
                syncInterval: 3600000,
                dataImported: {},
                settings: {
                    autoSync: false,
                    importCampaigns: true,
                    ...getDefaultSettingsForPlatform(platform)
                },
                createdAt: new Date().toISOString()
            };
            
            integrations.push(newIntegration);
            saveToStorage();
            renderIntegrationsGrid();
            closeAddIntegrationModal();
            
            addIntegrationLog(
                platformNames[platform],
                'Credenciais configuradas',
                'success',
                `Credenciais para ${platformNames[platform]} foram salvas com segurança`,
                `Campos configurados: ${Object.keys(credentials).join(', ')}`
            );
            
            showSuccessMessage(`🔐 Credenciais do ${platformNames[platform]} salvas com segurança! Agora você pode testar a conexão.`);
        }

        function getRequiredFieldsForPlatform(platform) {
            const requiredFields = {
                'google-ads': ['clientId', 'clientSecret'],
                'facebook-ads': ['accessToken', 'appId'],
                'linkedin-ads': ['clientId', 'clientSecret'],
                'google-analytics': ['trackingId'],
                'shopify': ['shopDomain', 'accessToken'],
                'webhook': ['webhookUrl'],
                'tiktok-ads': ['appId', 'secret'],
                'twitter-ads': ['consumerKey', 'consumerSecret']
            };
            return requiredFields[platform] || [];
        }

        function getApiVersionForPlatform(platform) {
            const apiVersions = {
                'google-ads': 'Google Ads API v13',
                'facebook-ads': 'Marketing API v18',
                'linkedin-ads': 'Campaign Manager API',
                'google-analytics': 'GA4 Measurement Protocol',
                'shopify': 'Admin API 2023-10',
                'webhook': 'HTTP/HTTPS',
                'tiktok-ads': 'Marketing API v1.3',
                'twitter-ads': 'Ads API v12'
            };
            return apiVersions[platform] || 'API v1.0';
        }

        function getDefaultSettingsForPlatform(platform) {
            const defaultSettings = {
                'google-ads': {
                    importKeywords: true,
                    importAds: true,
                    importExtensions: false
                },
                'facebook-ads': {
                    importAdSets: true,
                    importAds: true,
                    importAudiences: false
                },
                'linkedin-ads': {
                    importSponsored: true,
                    importAudiences: false
                },
                'google-analytics': {
                    importEvents: true,
                    importConversions: true
                },
                'shopify': {
                    importOrders: true,
                    importProducts: false,
                    importCustomers: false
                },
                'webhook': {
                    validateSignature: true
                },
                'tiktok-ads': {
                    importAdGroups: true,
                    importCreatives: false
                },
                'twitter-ads': {
                    importPromotedTweets: true,
                    importAudiences: false
                }
            };
            return defaultSettings[platform] || {};
        }

        // Navigation
        function showSection(sectionName) {
            // Hide all sections
            const sections = ['dashboard', 'clients', 'campaigns', 'budget', 'analytics', 'reports', 'integrations', 'users'];
            sections.forEach(section => {
                document.getElementById(section + '-section').classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(sectionName + '-section').classList.remove('hidden');
            
            // Update page title
            const titles = {
                'dashboard': 'Dashboard',
                'clients': 'Gestão de Clientes',
                'campaigns': 'Gerenciamento de Campanhas',
                'budget': 'Controle de Orçamento',
                'analytics': 'Análises e Métricas',
                'reports': 'Relatórios Personalizados',
                'integrations': 'Integrações com Plataformas',
                'users': 'Controle de Usuários'
            };
            document.getElementById('page-title').textContent = titles[sectionName];
            
            // Update active nav item - find the correct nav item by section name
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('bg-blue-50', 'text-blue-600');
                item.classList.add('text-gray-700');
                item.style.backgroundColor = '';
                item.style.color = '';
            });
            
            // Find and highlight the correct nav item
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                if (item.onclick && item.onclick.toString().includes(`'${sectionName}'`)) {
                    item.classList.add('bg-blue-50', 'text-blue-600');
                    item.classList.remove('text-gray-700');
                    item.style.backgroundColor = 'rgba(105, 116, 219, 0.3)';
                    item.style.color = '#6974DB';
                }
            });
            
            // Close mobile sidebar after navigation
            if (window.innerWidth < 1024) {
                closeMobileSidebar();
            }
            
            // Refresh data when switching sections
            if (sectionName === 'campaigns') {
                renderCampaignTable();
            } else if (sectionName === 'clients') {
                renderClientsGrid();
            } else if (sectionName === 'integrations') {
                renderIntegrationsGrid();
                renderIntegrationLogs();
            }
        }

        // Search clients function
        function searchClients() {
            const searchTerm = document.getElementById('clientSearch').value.toLowerCase();
            
            if (searchTerm === '') {
                filteredClients = [...clients];
            } else {
                filteredClients = clients.filter(client => 
                    client.name.toLowerCase().includes(searchTerm) ||
                    client.segment.toLowerCase().includes(searchTerm) ||
                    client.contact.toLowerCase().includes(searchTerm)
                );
            }
            
            renderClientsGrid();
        }

        // Filter campaigns function
        function filterCampaigns() {
            const clientFilter = document.getElementById('clientFilter').value;
            const channelFilter = document.getElementById('channelFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            
            filteredCampaigns = campaigns.filter(campaign => {
                const matchesClient = !clientFilter || campaign.client === clientFilter;
                const matchesChannel = !channelFilter || campaign.channel === channelFilter;
                const matchesStatus = !statusFilter || campaign.status === statusFilter;
                
                return matchesClient && matchesChannel && matchesStatus;
            });
            
            renderCampaignTable();
        }

        // Clear filters function
        function clearFilters() {
            document.getElementById('clientFilter').value = '';
            document.getElementById('channelFilter').value = '';
            document.getElementById('statusFilter').value = '';
            filteredCampaigns = [...campaigns];
            renderCampaignTable();
        }

        // Theme toggle (Light/Dark mode)
        function toggleDarkMode() {
            const body = document.body;
            const isDark = body.classList.contains('dark');
            const toggleButton = document.getElementById('darkModeToggle');
            
            if (isDark) {
                // Switch to light mode
                body.classList.remove('dark');
                body.classList.add('light');
                toggleButton.innerHTML = '<i class="fas fa-moon"></i>';
                toggleButton.title = 'Alternar para modo escuro';
                localStorage.setItem('trafficpro_theme', 'light');
            } else {
                // Switch to dark mode
                body.classList.remove('light');
                body.classList.add('dark');
                toggleButton.innerHTML = '<i class="fas fa-sun"></i>';
                toggleButton.title = 'Alternar para modo claro';
                localStorage.setItem('trafficpro_theme', 'dark');
            }
        }

        // Initialize theme from localStorage
        function initializeDarkMode() {
            const savedTheme = localStorage.getItem('trafficpro_theme') || 'light';
            const toggleButton = document.getElementById('darkModeToggle');
            const body = document.body;
            
            if (savedTheme === 'dark') {
                body.classList.add('dark');
                body.classList.remove('light');
                toggleButton.innerHTML = '<i class="fas fa-sun text-sm lg:text-base"></i>';
                toggleButton.title = 'Alternar para modo claro';
            } else {
                body.classList.add('light');
                body.classList.remove('dark');
                toggleButton.innerHTML = '<i class="fas fa-moon text-sm lg:text-base"></i>';
                toggleButton.title = 'Alternar para modo escuro';
            }
        }

        // Mobile sidebar functions
        function openMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            
            sidebar.classList.remove('sidebar-mobile');
            sidebar.classList.add('open');
            overlay.classList.add('active');
            
            // Prevent body scroll when sidebar is open
            document.body.style.overflow = 'hidden';
        }

        function closeMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            
            sidebar.classList.add('sidebar-mobile');
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
            
            // Restore body scroll
            document.body.style.overflow = '';
        }

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const menuButton = event.target.closest('[onclick*="openMobileSidebar"]');
            
            if (window.innerWidth < 1024 && !sidebar.contains(event.target) && !menuButton) {
                closeMobileSidebar();
            }
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 1024) {
                closeMobileSidebar();
            }
        });

        // Render campaign table
        function renderCampaignTable() {
            const tbody = document.querySelector('#campaigns-section tbody');
            if (!tbody) return;
            
            const campaignsToRender = filteredCampaigns.length > 0 ? filteredCampaigns : campaigns;
            
            tbody.innerHTML = campaignsToRender.map(campaign => {
                const isFinalized = campaign.status === 'Finalizada';
                const isInactive = isFinalized;
                
                // Styling for inactive campaigns
                const rowClass = isInactive ? 'hover:bg-gray-50 opacity-70' : 'hover:bg-gray-50';
                const textDecoration = isInactive ? 'text-decoration: line-through;' : '';
                const textColor = isFinalized ? 'color: #6b7280;' : '';
                
                return `
                    <tr class="${rowClass}" style="${textDecoration}">
                        <td class="px-6 py-4 font-medium" style="${textDecoration} ${textColor}">${campaign.name}</td>
                        <td class="px-6 py-4" style="${textDecoration} ${textColor}">${campaign.client}</td>
                        <td class="px-6 py-4">
                            <span class="bg-${campaign.channel === 'Facebook' ? 'blue' : campaign.channel === 'Google' ? 'red' : 'purple'}-100 text-${campaign.channel === 'Facebook' ? 'blue' : campaign.channel === 'Google' ? 'red' : 'purple'}-800 px-2 py-1 rounded-full text-xs" style="${textDecoration}">
                                ${campaign.channel}
                            </span>
                        </td>
                        <td class="px-6 py-4" style="${textDecoration} ${textColor}">R$ ${campaign.budget.toLocaleString()}</td>
                        <td class="px-6 py-4" style="${textDecoration} ${textColor}">R$ ${campaign.spent.toLocaleString()}</td>
                        <td class="px-6 py-4" style="${textDecoration} ${textColor}">${campaign.conversions}</td>
                        <td class="px-6 py-4 font-semibold text-green-600" style="${textDecoration} ${textColor}">${campaign.roas}x</td>
                        <td class="px-6 py-4">
                            <span class="bg-${campaign.status === 'Ativa' ? 'green' : campaign.status === 'Pausada' ? 'yellow' : 'gray'}-100 text-${campaign.status === 'Ativa' ? 'green' : campaign.status === 'Pausada' ? 'yellow' : 'gray'}-800 px-2 py-1 rounded-full text-xs">
                                ${campaign.status}
                            </span>
                        </td>
                        <td class="px-6 py-4">
                            ${!isInactive ? `
                                <button onclick="openEditCampaignModal(${campaign.id})" class="text-blue-600 hover:text-blue-800 mr-2" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="toggleCampaignStatus(${campaign.id})" class="text-yellow-600 hover:text-yellow-800 mr-2" title="${campaign.status === 'Ativa' ? 'Pausar' : 'Ativar'}">
                                    <i class="fas fa-${campaign.status === 'Ativa' ? 'pause' : 'play'}"></i>
                                </button>
                                <button onclick="finalizeCampaign(${campaign.id})" class="text-orange-600 hover:text-orange-800 mr-2" title="Finalizar">
                                    <i class="fas fa-flag-checkered"></i>
                                </button>
                            ` : `
                                <button onclick="reactivateCampaign(${campaign.id})" class="text-green-600 hover:text-green-800 mr-2" title="Reativar Campanha">
                                    <i class="fas fa-undo"></i>
                                </button>
                                <span class="text-gray-400 text-sm mr-2">${campaign.status}</span>
                            `}
                            <button onclick="deleteCampaign(${campaign.id})" class="text-red-600 hover:text-red-800" title="Deletar">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Campaign functions
        function saveCampaign(formData) {
            const newCampaign = {
                id: campaigns.length > 0 ? Math.max(...campaigns.map(c => c.id)) + 1 : 1,
                name: formData.get('campaignName'),
                client: formData.get('client'),
                channel: formData.get('channel'),
                budget: parseInt(formData.get('budget').replace(/[^\d]/g, '')),
                spent: 0,
                conversions: 0,
                roas: 0,
                status: 'Ativa',
                createdAt: new Date().toISOString()
            };
            
            campaigns.push(newCampaign);
            saveToStorage();
            renderCampaignTable();
            closeCampaignModal();
            
            // Show success message
            showSuccessMessage('Campanha criada e salva com sucesso!');
        }

        function openEditCampaignModal(id) {
            const campaign = campaigns.find(c => c.id === id);
            if (campaign) {
                // Populate edit form
                document.getElementById('editCampaignId').value = campaign.id;
                document.getElementById('editCampaignName').value = campaign.name;
                document.getElementById('editCampaignClient').value = campaign.client;
                document.getElementById('editCampaignChannel').value = campaign.channel;
                document.getElementById('editCampaignBudget').value = `R$ ${campaign.budget.toLocaleString()}`;
                document.getElementById('editCampaignStatus').value = campaign.status;
                document.getElementById('editCampaignSpent').value = `R$ ${campaign.spent.toLocaleString()}`;
                document.getElementById('editCampaignConversions').value = campaign.conversions;
                document.getElementById('editCampaignRoas').value = campaign.roas;
                
                // Show modal
                document.getElementById('editCampaignModal').classList.remove('hidden');
            }
        }

        function closeEditCampaignModal() {
            document.getElementById('editCampaignModal').classList.add('hidden');
            document.getElementById('editCampaignModal').querySelector('form').reset();
        }

        function handleEditCampaignSubmit(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const campaignId = parseInt(formData.get('campaignId'));
            
            const campaign = campaigns.find(c => c.id === campaignId);
            if (campaign) {
                campaign.name = formData.get('campaignName');
                campaign.client = formData.get('client');
                campaign.channel = formData.get('channel');
                campaign.budget = parseInt(formData.get('budget').replace(/[^\d]/g, ''));
                campaign.status = formData.get('status');
                campaign.spent = parseInt(formData.get('spent').replace(/[^\d]/g, '')) || 0;
                campaign.conversions = parseInt(formData.get('conversions')) || 0;
                campaign.roas = parseFloat(formData.get('roas')) || 0;
                
                saveToStorage();
                renderCampaignTable();
                closeEditCampaignModal();
                
                showSuccessMessage('Campanha atualizada com sucesso!');
            }
        }

        function toggleCampaignStatus(id) {
            const campaign = campaigns.find(c => c.id === id);
            if (campaign) {
                const newStatus = campaign.status === 'Ativa' ? 'Pausada' : 'Ativa';
                const action = newStatus === 'Ativa' ? 'ATIVAR' : 'PAUSAR';
                const icon = newStatus === 'Ativa' ? '▶️' : '⏸️';
                
                showConfirmModal(
                    `${icon} ${action} CAMPANHA\n\nDeseja realmente ${action} a campanha "${campaign.name}"?\n\n${newStatus === 'Ativa' ? 
                        '✅ AO ATIVAR:\n• A campanha voltará a veicular anúncios\n• Investimentos serão retomados\n• Métricas voltarão a ser coletadas\n• Orçamento diário será consumido' : 
                        '⏸️ AO PAUSAR:\n• Todos os anúncios serão pausados\n• Investimentos serão suspensos\n• Dados atuais serão preservados\n• Pode ser reativada a qualquer momento'}\n\nEsta é uma ação temporária e reversível.`,
                    () => {
                        campaign.status = newStatus;
                        saveToStorage();
                        renderCampaignTable();
                        showSuccessMessage(`${icon} Campanha "${campaign.name}" foi ${newStatus.toUpperCase()}! ${newStatus === 'Ativa' ? 'Os anúncios estão veiculando novamente.' : 'Todos os anúncios foram pausados.'}`);
                    }
                );
            }
        }

        function finalizeCampaign(id) {
            const campaign = campaigns.find(c => c.id === id);
            if (campaign) {
                showConfirmModal(
                    `🏁 FINALIZAR CAMPANHA\n\nDeseja realmente FINALIZAR a campanha "${campaign.name}"?\n\n⚠️ ATENÇÃO:\n• A campanha será marcada como CONCLUÍDA\n• Não poderá mais receber investimentos\n• Dados e métricas serão preservados\n• Pode ser reativada posteriormente se necessário\n\nEsta é uma ação de encerramento controlado da campanha.`,
                    () => {
                        campaign.status = 'Finalizada';
                        saveToStorage();
                        renderCampaignTable();
                        showSuccessMessage(`✅ Campanha "${campaign.name}" foi FINALIZADA com sucesso! A campanha está agora concluída e seus dados foram preservados.`);
                    }
                );
            }
        }



        function reactivateCampaign(id) {
            const campaign = campaigns.find(c => c.id === id);
            if (campaign) {
                showConfirmModal(
                    `🔄 REATIVAR CAMPANHA\n\nDeseja realmente REATIVAR a campanha "${campaign.name}"?\n\n✅ O QUE ACONTECE:\n• A campanha voltará ao status "PAUSADA"\n• Todos os controles serão liberados\n• Poderá editar, ativar e gerenciar normalmente\n• Histórico e dados serão mantidos\n• Investimentos poderão ser retomados\n\nA campanha estará pronta para ser ativada novamente.`,
                    () => {
                        campaign.status = 'Pausada';
                        saveToStorage();
                        renderCampaignTable();
                        showSuccessMessage(`🎯 Campanha "${campaign.name}" foi REATIVADA com sucesso! Status alterado para "Pausada" - agora você pode gerenciá-la normalmente.`);
                    }
                );
            }
        }

        // Export menu toggle
        function toggleExportMenu(type) {
            const menu = document.getElementById(`${type}-export-menu`);
            const isHidden = menu.classList.contains('hidden');
            
            // Close all menus first
            document.querySelectorAll('[id$="-export-menu"]').forEach(m => m.classList.add('hidden'));
            
            // Toggle current menu
            if (isHidden) {
                menu.classList.remove('hidden');
            }
        }

        // Close menus when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('[onclick*="toggleExportMenu"]') && !event.target.closest('[id$="-export-menu"]')) {
                document.querySelectorAll('[id$="-export-menu"]').forEach(menu => menu.classList.add('hidden'));
            }
        });

        // Enhanced Export functions
        function exportCampaigns(format = 'excel') {
            if (format === 'excel') {
                exportCampaignsToExcel();
            } else {
                exportCampaignsToCSV();
            }
            // Close menu
            document.getElementById('campaigns-export-menu').classList.add('hidden');
        }

        function exportClients(format = 'excel') {
            if (format === 'excel') {
                exportClientsToExcel();
            } else {
                exportClientsToCSV();
            }
            // Close menu
            document.getElementById('clients-export-menu').classList.add('hidden');
        }

        // Excel Export Functions
        function exportCampaignsToExcel() {
            const data = campaigns.map(campaign => ({
                'ID': campaign.id,
                'Nome da Campanha': campaign.name,
                'Cliente': campaign.client,
                'Canal': campaign.channel,
                'Orçamento': campaign.budget,
                'Valor Gasto': campaign.spent,
                'Conversões': campaign.conversions,
                'ROAS': campaign.roas,
                'Status': campaign.status,
                'Data de Criação': new Date(campaign.createdAt).toLocaleDateString('pt-BR'),
                'Utilização do Orçamento (%)': Math.round((campaign.spent / campaign.budget) * 100),
                'Receita Estimada': Math.round(campaign.spent * campaign.roas)
            }));

            const worksheet = XLSX.utils.json_to_sheet(data);
            
            // Configurar largura das colunas
            const columnWidths = [
                { wch: 5 },   // ID
                { wch: 25 },  // Nome da Campanha
                { wch: 20 },  // Cliente
                { wch: 12 },  // Canal
                { wch: 15 },  // Orçamento
                { wch: 15 },  // Valor Gasto
                { wch: 12 },  // Conversões
                { wch: 8 },   // ROAS
                { wch: 10 },  // Status
                { wch: 15 },  // Data de Criação
                { wch: 20 },  // Utilização do Orçamento
                { wch: 18 }   // Receita Estimada
            ];
            worksheet['!cols'] = columnWidths;

            // Aplicar formatação aos cabeçalhos
            const range = XLSX.utils.decode_range(worksheet['!ref']);
            for (let col = range.s.c; col <= range.e.c; col++) {
                const cellAddress = XLSX.utils.encode_cell({ r: 0, c: col });
                if (!worksheet[cellAddress]) continue;
                worksheet[cellAddress].s = {
                    font: { bold: true, color: { rgb: "FFFFFF" } },
                    fill: { fgColor: { rgb: "4F46E5" } },
                    alignment: { horizontal: "center" }
                };
            }

            // Formatação de valores monetários
            for (let row = 1; row <= range.e.r; row++) {
                // Orçamento (coluna D)
                const budgetCell = XLSX.utils.encode_cell({ r: row, c: 4 });
                if (worksheet[budgetCell]) {
                    worksheet[budgetCell].z = 'R$ #,##0.00';
                }
                
                // Valor Gasto (coluna E)
                const spentCell = XLSX.utils.encode_cell({ r: row, c: 5 });
                if (worksheet[spentCell]) {
                    worksheet[spentCell].z = 'R$ #,##0.00';
                }
                
                // Receita Estimada (coluna L)
                const revenueCell = XLSX.utils.encode_cell({ r: row, c: 11 });
                if (worksheet[revenueCell]) {
                    worksheet[revenueCell].z = 'R$ #,##0.00';
                }
            }

            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Campanhas');
            
            // Adicionar metadados
            workbook.Props = {
                Title: "Relatório de Campanhas - TrafficPro",
                Subject: "Dados de Campanhas de Tráfego Pago",
                Author: "TrafficPro System",
                CreatedDate: new Date()
            };

            XLSX.writeFile(workbook, `campanhas_trafficpro_${new Date().toISOString().split('T')[0]}.xlsx`);
            showSuccessMessage('Planilha Excel das campanhas exportada com sucesso!');
        }

        function exportClientsToExcel() {
            const data = clients.map(client => {
                const clientCampaigns = campaigns.filter(c => c.client === client.name);
                const totalSpent = clientCampaigns.reduce((sum, c) => sum + c.spent, 0);
                const totalRevenue = clientCampaigns.reduce((sum, c) => sum + (c.spent * c.roas), 0);
                const avgRoas = clientCampaigns.length > 0 ? 
                    (clientCampaigns.reduce((sum, c) => sum + c.roas, 0) / clientCampaigns.length) : 0;
                const activeCampaigns = clientCampaigns.filter(c => c.status === 'Ativa').length;
                
                return {
                    'ID': client.id,
                    'Nome do Cliente': client.name,
                    'Segmento': client.segment,
                    'Orçamento Mensal': client.budget,
                    'Email de Contato': client.contact,
                    'Total de Campanhas': clientCampaigns.length,
                    'Campanhas Ativas': activeCampaigns,
                    'Investimento Total': totalSpent,
                    'Receita Gerada': Math.round(totalRevenue),
                    'ROAS Médio': parseFloat(avgRoas.toFixed(2)),
                    'Utilização do Orçamento (%)': Math.round((totalSpent / client.budget) * 100),
                    'Data de Cadastro': new Date(client.createdAt).toLocaleDateString('pt-BR'),
                    'Status': totalSpent > 0 ? 'Ativo' : 'Inativo'
                };
            });

            const worksheet = XLSX.utils.json_to_sheet(data);
            
            // Configurar largura das colunas
            const columnWidths = [
                { wch: 5 },   // ID
                { wch: 25 },  // Nome do Cliente
                { wch: 15 },  // Segmento
                { wch: 18 },  // Orçamento Mensal
                { wch: 30 },  // Email de Contato
                { wch: 18 },  // Total de Campanhas
                { wch: 18 },  // Campanhas Ativas
                { wch: 18 },  // Investimento Total
                { wch: 18 },  // Receita Gerada
                { wch: 12 },  // ROAS Médio
                { wch: 22 },  // Utilização do Orçamento
                { wch: 18 },  // Data de Cadastro
                { wch: 10 }   // Status
            ];
            worksheet['!cols'] = columnWidths;

            // Aplicar formatação aos cabeçalhos
            const range = XLSX.utils.decode_range(worksheet['!ref']);
            for (let col = range.s.c; col <= range.e.c; col++) {
                const cellAddress = XLSX.utils.encode_cell({ r: 0, c: col });
                if (!worksheet[cellAddress]) continue;
                worksheet[cellAddress].s = {
                    font: { bold: true, color: { rgb: "FFFFFF" } },
                    fill: { fgColor: { rgb: "10B981" } },
                    alignment: { horizontal: "center" }
                };
            }

            // Formatação de valores monetários
            for (let row = 1; row <= range.e.r; row++) {
                // Orçamento Mensal (coluna D)
                const budgetCell = XLSX.utils.encode_cell({ r: row, c: 3 });
                if (worksheet[budgetCell]) {
                    worksheet[budgetCell].z = 'R$ #,##0.00';
                }
                
                // Investimento Total (coluna H)
                const investmentCell = XLSX.utils.encode_cell({ r: row, c: 7 });
                if (worksheet[investmentCell]) {
                    worksheet[investmentCell].z = 'R$ #,##0.00';
                }
                
                // Receita Gerada (coluna I)
                const revenueCell = XLSX.utils.encode_cell({ r: row, c: 8 });
                if (worksheet[revenueCell]) {
                    worksheet[revenueCell].z = 'R$ #,##0.00';
                }
            }

            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Clientes');
            
            // Adicionar metadados
            workbook.Props = {
                Title: "Relatório de Clientes - TrafficPro",
                Subject: "Dados de Clientes e Performance",
                Author: "TrafficPro System",
                CreatedDate: new Date()
            };

            XLSX.writeFile(workbook, `clientes_trafficpro_${new Date().toISOString().split('T')[0]}.xlsx`);
            showSuccessMessage('Planilha Excel dos clientes exportada com sucesso!');
        }

        // CSV Export Functions (melhoradas)
        function exportCampaignsToCSV() {
            const headers = ['ID', 'Nome da Campanha', 'Cliente', 'Canal', 'Orçamento', 'Valor Gasto', 'Conversões', 'ROAS', 'Status', 'Data de Criação', 'Utilização (%)', 'Receita Estimada'];
            const rows = campaigns.map(campaign => [
                campaign.id,
                `"${campaign.name}"`,
                `"${campaign.client}"`,
                campaign.channel,
                campaign.budget,
                campaign.spent,
                campaign.conversions,
                campaign.roas,
                campaign.status,
                new Date(campaign.createdAt).toLocaleDateString('pt-BR'),
                Math.round((campaign.spent / campaign.budget) * 100),
                Math.round(campaign.spent * campaign.roas)
            ]);
            
            const csvContent = '\uFEFF' + [headers, ...rows].map(row => row.join(';')).join('\n');
            downloadFile(csvContent, `campanhas_trafficpro_${new Date().toISOString().split('T')[0]}.csv`, 'text/csv;charset=utf-8;');
            showSuccessMessage('Arquivo CSV das campanhas exportado com sucesso!');
        }

        function exportClientsToCSV() {
            const headers = ['ID', 'Nome do Cliente', 'Segmento', 'Orçamento Mensal', 'Email de Contato', 'Total Campanhas', 'Campanhas Ativas', 'Investimento Total', 'Receita Gerada', 'ROAS Médio', 'Utilização (%)', 'Data de Cadastro', 'Status'];
            const rows = clients.map(client => {
                const clientCampaigns = campaigns.filter(c => c.client === client.name);
                const totalSpent = clientCampaigns.reduce((sum, c) => sum + c.spent, 0);
                const totalRevenue = clientCampaigns.reduce((sum, c) => sum + (c.spent * c.roas), 0);
                const avgRoas = clientCampaigns.length > 0 ? 
                    (clientCampaigns.reduce((sum, c) => sum + c.roas, 0) / clientCampaigns.length).toFixed(2) : 0;
                const activeCampaigns = clientCampaigns.filter(c => c.status === 'Ativa').length;
                
                return [
                    client.id,
                    `"${client.name}"`,
                    client.segment,
                    client.budget,
                    `"${client.contact}"`,
                    clientCampaigns.length,
                    activeCampaigns,
                    totalSpent,
                    Math.round(totalRevenue),
                    avgRoas,
                    Math.round((totalSpent / client.budget) * 100),
                    new Date(client.createdAt).toLocaleDateString('pt-BR'),
                    totalSpent > 0 ? 'Ativo' : 'Inativo'
                ];
            });
            
            const csvContent = '\uFEFF' + [headers, ...rows].map(row => row.join(';')).join('\n');
            downloadFile(csvContent, `clientes_trafficpro_${new Date().toISOString().split('T')[0]}.csv`, 'text/csv;charset=utf-8;');
            showSuccessMessage('Arquivo CSV dos clientes exportado com sucesso!');
        }

        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        // Success message function
        function showSuccessMessage(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-check-circle mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Error message function
        function showErrorMessage(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-exclamation-circle mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Remove after 4 seconds
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 4000);
        }

        // Client functions
        function saveClient(formData) {
            const newClient = {
                id: clients.length > 0 ? Math.max(...clients.map(c => c.id)) + 1 : 1,
                name: formData.get('companyName'),
                segment: formData.get('segment'),
                budget: parseInt(formData.get('budget').replace(/[^\d]/g, '')),
                contact: formData.get('contact'),
                createdAt: new Date().toISOString()
            };
            
            clients.push(newClient);
            
            // Atualizar arrays filtrados para incluir o novo cliente
            filteredClients = [...clients];
            
            saveToStorage();
            renderClientsGrid();
            closeClientModal();
            
            // Show success message
            showSuccessMessage('Cliente cadastrado e salvo com sucesso!');
        }

        function renderClientsGrid() {
            const grid = document.getElementById('clients-grid');
            if (!grid) return;
            
            const clientsToRender = filteredClients.length > 0 ? filteredClients : clients;
            
            grid.innerHTML = clientsToRender.map(client => {
                const clientCampaigns = campaigns.filter(c => c.client === client.name);
                const totalSpent = clientCampaigns.reduce((sum, c) => sum + c.spent, 0);
                const avgRoas = clientCampaigns.length > 0 ? 
                    (clientCampaigns.reduce((sum, c) => sum + c.roas, 0) / clientCampaigns.length).toFixed(1) : 0;
                
                return `
                    <div class="bg-white p-2 lg:p-3 rounded-md shadow-sm card-hover mobile-p-2" style="width: 270px;">
                        <div class="flex items-center justify-between mb-1 lg:mb-2 mobile-mb-1">
                            <h4 class="font-semibold text-xs lg:text-sm mobile-text-xs">${client.name}</h4>
                            <div class="flex items-center space-x-1 mobile-space-x-1">
                                <span class="bg-green-100 text-green-800 px-1.5 py-0.5 rounded-full text-xs">Ativo</span>
                                <button onclick="deleteClient(${client.id})" class="text-red-600 hover:text-red-800 p-0.5" title="Deletar Cliente">
                                    <i class="fas fa-trash text-xs"></i>
                                </button>
                            </div>
                        </div>
                        <p class="text-xs text-gray-600 mb-1 mobile-text-xs">${client.segment}</p>
                        <div class="space-y-0.5 text-xs mobile-text-xs mobile-space-y-0.5">
                            <div class="flex justify-between">
                                <span>Campanhas:</span>
                                <span class="font-medium">${clientCampaigns.length}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Orçamento:</span>
                                <span class="font-medium">R$ ${client.budget.toLocaleString()}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Investimento:</span>
                                <span class="font-medium">R$ ${totalSpent.toLocaleString()}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ROAS Médio:</span>
                                <span class="font-medium text-green-600">${avgRoas}x</span>
                            </div>
                        </div>
                        <div class="mt-1.5 flex flex-col sm:flex-row space-y-0.5 sm:space-y-0 sm:space-x-1 btn-group-responsive mobile-mt-1.5 mobile-space-y-0.5">
                            <button onclick="editClient(${client.id})" class="bg-blue-50 text-blue-600 py-1 px-2 rounded text-xs hover:bg-blue-100 btn-responsive" style="width: 120px;">Editar</button>
                            <button onclick="generateClientReport(${client.id})" class="bg-gray-50 text-gray-600 py-1 px-2 rounded text-xs hover:bg-gray-100 btn-responsive" style="width: 120px;">Relatório</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function editClient(id) {
            const client = clients.find(c => c.id === id);
            if (client) {
                // Populate edit form
                document.getElementById('editClientId').value = client.id;
                document.getElementById('editCompanyName').value = client.name;
                document.getElementById('editSegment').value = client.segment;
                document.getElementById('editBudget').value = `R$ ${client.budget.toLocaleString()}`;
                document.getElementById('editContact').value = client.contact;
                
                // Show modal
                document.getElementById('editClientModal').classList.remove('hidden');
            }
        }

        function generateClientReport(id) {
            const client = clients.find(c => c.id === id);
            if (client) {
                const clientCampaigns = campaigns.filter(c => c.client === client.name);
                const totalSpent = clientCampaigns.reduce((sum, c) => sum + c.spent, 0);
                const totalRevenue = clientCampaigns.reduce((sum, c) => sum + (c.spent * c.roas), 0);
                const avgRoas = clientCampaigns.length > 0 ? 
                    (clientCampaigns.reduce((sum, c) => sum + c.roas, 0) / clientCampaigns.length) : 0;
                const activeCampaigns = clientCampaigns.filter(c => c.status === 'Ativa').length;
                const totalConversions = clientCampaigns.reduce((sum, c) => sum + c.conversions, 0);
                
                const reportContent = `
                    <div class="space-y-6">
                        <!-- Header -->
                        <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-xl">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h2 class="text-2xl font-bold">${client.name}</h2>
                                    <p class="opacity-90">${client.segment} • ${client.contact}</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm opacity-75">Período de Análise</p>
                                    <p class="font-semibold">Últimos 30 dias</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Métricas Principais -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-blue-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-blue-600">R$ ${totalSpent.toLocaleString()}</div>
                                <div class="text-sm text-gray-600">Investimento Total</div>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-green-600">R$ ${Math.round(totalRevenue).toLocaleString()}</div>
                                <div class="text-sm text-gray-600">Receita Gerada</div>
                            </div>
                            <div class="bg-purple-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-purple-600">${avgRoas.toFixed(1)}x</div>
                                <div class="text-sm text-gray-600">ROAS Médio</div>
                            </div>
                            <div class="bg-orange-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-orange-600">${totalConversions}</div>
                                <div class="text-sm text-gray-600">Conversões</div>
                            </div>
                        </div>
                        
                        <!-- Campanhas Ativas -->
                        <div class="bg-white border rounded-xl">
                            <div class="p-4 border-b">
                                <h3 class="text-lg font-semibold">Campanhas (${clientCampaigns.length} total, ${activeCampaigns} ativas)</h3>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Campanha</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Canal</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Investimento</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Conversões</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">ROAS</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-200">
                                        ${clientCampaigns.map(campaign => `
                                            <tr>
                                                <td class="px-4 py-2 font-medium">${campaign.name}</td>
                                                <td class="px-4 py-2">
                                                    <span class="bg-${campaign.channel === 'Facebook' ? 'blue' : campaign.channel === 'Google' ? 'red' : 'purple'}-100 text-${campaign.channel === 'Facebook' ? 'blue' : campaign.channel === 'Google' ? 'red' : 'purple'}-800 px-2 py-1 rounded-full text-xs">
                                                        ${campaign.channel}
                                                    </span>
                                                </td>
                                                <td class="px-4 py-2">R$ ${campaign.spent.toLocaleString()}</td>
                                                <td class="px-4 py-2">${campaign.conversions}</td>
                                                <td class="px-4 py-2 font-semibold text-green-600">${campaign.roas}x</td>
                                                <td class="px-4 py-2">
                                                    <span class="bg-${campaign.status === 'Ativa' ? 'green' : 'yellow'}-100 text-${campaign.status === 'Ativa' ? 'green' : 'yellow'}-800 px-2 py-1 rounded-full text-xs">
                                                        ${campaign.status}
                                                    </span>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Análise de Performance -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white border rounded-xl p-4">
                                <h3 class="text-lg font-semibold mb-4">Distribuição por Canal</h3>
                                <div class="space-y-3">
                                    ${Array.from(new Set(clientCampaigns.map(c => c.channel))).map(channel => {
                                        const channelCampaigns = clientCampaigns.filter(c => c.channel === channel);
                                        const channelSpent = channelCampaigns.reduce((sum, c) => sum + c.spent, 0);
                                        const percentage = totalSpent > 0 ? Math.round((channelSpent / totalSpent) * 100) : 0;
                                        return `
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium">${channel}</span>
                                                <div class="flex items-center space-x-2">
                                                    <div class="w-20 bg-gray-200 rounded-full h-2">
                                                        <div class="bg-blue-600 h-2 rounded-full" style="width: ${percentage}%"></div>
                                                    </div>
                                                    <span class="text-sm text-gray-600">${percentage}%</span>
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                            
                            <div class="bg-white border rounded-xl p-4">
                                <h3 class="text-lg font-semibold mb-4">Resumo Financeiro</h3>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Orçamento Mensal:</span>
                                        <span class="font-semibold">R$ ${client.budget.toLocaleString()}</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Utilização:</span>
                                        <span class="font-semibold">${Math.round((totalSpent / client.budget) * 100)}%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Lucro Estimado:</span>
                                        <span class="font-semibold text-green-600">R$ ${Math.round(totalRevenue - totalSpent).toLocaleString()}</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Margem de Lucro:</span>
                                        <span class="font-semibold text-green-600">${totalRevenue > 0 ? Math.round(((totalRevenue - totalSpent) / totalRevenue) * 100) : 0}%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ações -->
                        <div class="flex justify-end space-x-3 pt-4 border-t">
                            <button onclick="exportClientReport('${client.name}')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                                <i class="fas fa-download mr-2"></i>Exportar PDF
                            </button>
                            <button onclick="closeClientReportModal()" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300">
                                Fechar Relatório
                            </button>
                        </div>
                    </div>
                `;
                
                document.getElementById('clientReportContent').innerHTML = reportContent;
                document.getElementById('clientReportModal').classList.remove('hidden');
            }
        }

        // Modal functions
        function openClientModal() {
            document.getElementById('clientModal').classList.remove('hidden');
        }
        
        function closeClientModal() {
            document.getElementById('clientModal').classList.add('hidden');
            document.getElementById('clientModal').querySelector('form').reset();
        }
        
        function openCampaignModal() {
            // Populate client options
            const clientSelect = document.querySelector('#campaignModal select[name="client"]');
            clientSelect.innerHTML = clients.map(client => 
                `<option value="${client.name}">${client.name}</option>`
            ).join('');
            
            document.getElementById('campaignModal').classList.remove('hidden');
        }
        
        function closeCampaignModal() {
            document.getElementById('campaignModal').classList.add('hidden');
            document.getElementById('campaignModal').querySelector('form').reset();
        }
        
        function openUserModal() {
            document.getElementById('userModal').classList.remove('hidden');
        }
        
        function closeUserModal() {
            document.getElementById('userModal').classList.add('hidden');
            document.getElementById('userModal').querySelector('form').reset();
        }

        function closeEditClientModal() {
            document.getElementById('editClientModal').classList.add('hidden');
            document.getElementById('editClientModal').querySelector('form').reset();
        }

        function closeClientReportModal() {
            document.getElementById('clientReportModal').classList.add('hidden');
        }

        function exportClientReport(clientName) {
            const client = clients.find(c => c.name === clientName);
            if (!client) return;
            
            const clientCampaigns = campaigns.filter(c => c.client === client.name);
            const totalSpent = clientCampaigns.reduce((sum, c) => sum + c.spent, 0);
            const totalRevenue = clientCampaigns.reduce((sum, c) => sum + (c.spent * c.roas), 0);
            const avgRoas = clientCampaigns.length > 0 ? 
                (clientCampaigns.reduce((sum, c) => sum + c.roas, 0) / clientCampaigns.length) : 0;
            const totalConversions = clientCampaigns.reduce((sum, c) => sum + c.conversions, 0);
            
            try {
                // Create PDF using jsPDF
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Header with gradient background
                doc.setFillColor(79, 70, 229);
                doc.rect(0, 0, 210, 40, 'F');
                
                // Title
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(24);
                doc.setFont('helvetica', 'bold');
                doc.text('TrafficPro', 20, 25);
                
                doc.setFontSize(14);
                doc.setFont('helvetica', 'normal');
                doc.text('Relatório de Cliente', 20, 35);
                
                // Client information
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(18);
                doc.setFont('helvetica', 'bold');
                doc.text(client.name, 20, 55);
                
                doc.setFontSize(12);
                doc.setFont('helvetica', 'normal');
                doc.text(`Segmento: ${client.segment}`, 20, 65);
                doc.text(`Contato: ${client.contact}`, 20, 75);
                doc.text(`Data do Relatório: ${new Date().toLocaleDateString('pt-BR')}`, 20, 85);
                
                // Metrics boxes
                const metrics = [
                    { label: 'Investimento Total', value: `R$ ${totalSpent.toLocaleString('pt-BR')}`, x: 20, y: 100 },
                    { label: 'Receita Gerada', value: `R$ ${Math.round(totalRevenue).toLocaleString('pt-BR')}`, x: 110, y: 100 },
                    { label: 'ROAS Médio', value: `${avgRoas.toFixed(1)}x`, x: 20, y: 130 },
                    { label: 'Conversões', value: totalConversions.toString(), x: 110, y: 130 }
                ];
                
                metrics.forEach(metric => {
                    // Box border
                    doc.setDrawColor(200, 200, 200);
                    doc.setLineWidth(0.5);
                    doc.rect(metric.x, metric.y, 80, 25);
                    
                    // Label
                    doc.setFontSize(10);
                    doc.setTextColor(100, 100, 100);
                    doc.setFont('helvetica', 'normal');
                    doc.text(metric.label, metric.x + 5, metric.y + 10);
                    
                    // Value
                    doc.setFontSize(14);
                    doc.setFont('helvetica', 'bold');
                    doc.setTextColor(0, 0, 0);
                    doc.text(metric.value, metric.x + 5, metric.y + 20);
                });
                
                // Campaigns table
                if (clientCampaigns.length > 0) {
                    const tableData = clientCampaigns.map(campaign => [
                        campaign.name,
                        campaign.channel,
                        `R$ ${campaign.spent.toLocaleString('pt-BR')}`,
                        campaign.conversions.toString(),
                        `${campaign.roas}x`,
                        campaign.status
                    ]);
                    
                    doc.autoTable({
                        head: [['Campanha', 'Canal', 'Investimento', 'Conversões', 'ROAS', 'Status']],
                        body: tableData,
                        startY: 170,
                        theme: 'grid',
                        headStyles: { 
                            fillColor: [79, 70, 229],
                            textColor: [255, 255, 255],
                            fontSize: 10,
                            fontStyle: 'bold'
                        },
                        styles: { 
                            fontSize: 9,
                            cellPadding: 3
                        },
                        columnStyles: {
                            0: { cellWidth: 35 },
                            1: { cellWidth: 25 },
                            2: { cellWidth: 30 },
                            3: { cellWidth: 25 },
                            4: { cellWidth: 20 },
                            5: { cellWidth: 25 }
                        }
                    });
                }
                
                // Footer
                const pageCount = doc.internal.getNumberOfPages();
                for (let i = 1; i <= pageCount; i++) {
                    doc.setPage(i);
                    doc.setFontSize(8);
                    doc.setTextColor(150, 150, 150);
                    doc.setFont('helvetica', 'normal');
                    doc.text(`Página ${i} de ${pageCount}`, 20, 285);
                    doc.text('Gerado pelo TrafficPro - Sistema de Gestão de Tráfego Pago', 20, 290);
                }
                
                // Save PDF
                const fileName = `relatorio_${client.name.replace(/\s+/g, '_').toLowerCase()}_${new Date().toISOString().split('T')[0]}.pdf`;
                doc.save(fileName);
                showSuccessMessage(`Relatório PDF de ${clientName} exportado com sucesso!`);
                
            } catch (error) {
                console.error('Erro ao gerar PDF:', error);
                showErrorMessage('Erro ao gerar o relatório PDF. Tente novamente.');
            }
        }

        // Delete functions
        function deleteClient(id) {
            const client = clients.find(c => c.id === id);
            if (client) {
                const clientCampaigns = campaigns.filter(c => c.client === client.name);
                let message = `🗑️ DELETAR CLIENTE PERMANENTEMENTE\n\nDeseja realmente DELETAR o cliente "${client.name}"?\n\n🚨 ATENÇÃO - AÇÃO IRREVERSÍVEL:`;
                
                if (clientCampaigns.length > 0) {
                    message += `\n• O cliente será REMOVIDO permanentemente\n• TODAS as ${clientCampaigns.length} campanha(s) associada(s) serão DELETADAS\n• TODOS os dados, métricas e histórico serão PERDIDOS\n• Relatórios não poderão mais ser gerados\n• Esta ação NÃO PODE ser desfeita\n\n⚠️ IMPACTO: ${clientCampaigns.length} campanhas serão perdidas junto com o cliente!`;
                } else {
                    message += `\n• O cliente será REMOVIDO permanentemente\n• Dados de contato e informações serão PERDIDOS\n• Esta ação NÃO PODE ser desfeita\n\n✅ Nenhuma campanha será afetada (cliente sem campanhas ativas).`;
                }
                
                showConfirmModal(message, () => {
                    // Remove client campaigns first
                    campaigns = campaigns.filter(c => c.client !== client.name);
                    // Remove client
                    clients = clients.filter(c => c.id !== id);
                    
                    // Update filtered arrays
                    filteredCampaigns = filteredCampaigns.filter(c => c.client !== client.name);
                    filteredClients = filteredClients.filter(c => c.id !== id);
                    
                    saveToStorage();
                    renderClientsGrid();
                    renderCampaignTable();
                    
                    if (clientCampaigns.length > 0) {
                        showSuccessMessage(`🗑️ Cliente "${client.name}" foi DELETADO permanentemente! ${clientCampaigns.length} campanha(s) também foram removidas do sistema.`);
                    } else {
                        showSuccessMessage(`🗑️ Cliente "${client.name}" foi DELETADO permanentemente! Nenhuma campanha foi afetada.`);
                    }
                });
            }
        }

        function deleteCampaign(id) {
            const campaign = campaigns.find(c => c.id === id);
            if (campaign) {
                showConfirmModal(
                    `🗑️ DELETAR CAMPANHA PERMANENTEMENTE\n\nDeseja realmente DELETAR a campanha "${campaign.name}"?\n\n🚨 ATENÇÃO - AÇÃO IRREVERSÍVEL:\n• A campanha será REMOVIDA permanentemente\n• TODOS os dados e métricas serão PERDIDOS\n• Histórico de performance será APAGADO\n• Relatórios não poderão mais ser gerados\n• Esta ação NÃO PODE ser desfeita\n\n⚠️ Considere CANCELAR ao invés de deletar se quiser preservar os dados.`,
                    () => {
                        campaigns = campaigns.filter(c => c.id !== id);
                        filteredCampaigns = filteredCampaigns.filter(c => c.id !== id);
                        
                        saveToStorage();
                        renderCampaignTable();
                        showSuccessMessage(`🗑️ Campanha "${campaign.name}" foi DELETADA permanentemente! Todos os dados foram removidos do sistema.`);
                    }
                );
            }
        }

        // Confirmation modal functions
        function showConfirmModal(message, onConfirm) {
            document.getElementById('confirmMessage').textContent = message;
            document.getElementById('confirmButton').onclick = () => {
                onConfirm();
                closeConfirmModal();
            };
            document.getElementById('confirmModal').classList.remove('hidden');
        }

        function closeConfirmModal() {
            document.getElementById('confirmModal').classList.add('hidden');
        }

        // Form submit handlers
        function handleClientSubmit(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            saveClient(formData);
        }

        function handleCampaignSubmit(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            saveCampaign(formData);
        }

        function handleEditClientSubmit(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const clientId = parseInt(formData.get('clientId'));
            
            const client = clients.find(c => c.id === clientId);
            if (client) {
                client.name = formData.get('companyName');
                client.segment = formData.get('segment');
                client.budget = parseInt(formData.get('budget').replace(/[^\d]/g, ''));
                client.contact = formData.get('contact');
                
                // Atualizar arrays filtrados
                filteredClients = [...clients];
                
                saveToStorage();
                renderClientsGrid();
                closeEditClientModal();
                
                showSuccessMessage('Cliente atualizado com sucesso!');
            }
        }

        // Report generation
        function generateReport() {
            alert('Relatório sendo gerado! Você receberá um email quando estiver pronto.');
        }

        // Integration Action Functions
        function connectIntegration(id) {
            const integration = integrations.find(i => i.id === id);
            if (!integration) return;
            
            showConfirmModal(
                `🔗 CONECTAR INTEGRAÇÃO\n\nDeseja conectar a integração com ${integration.name}?\n\n✅ O QUE ACONTECE:\n• Sistema tentará estabelecer conexão com a API\n• Credenciais serão validadas\n• Sincronização automática será ativada\n• Dados começarão a ser importados\n\nEsta ação pode levar alguns segundos para ser concluída.`,
                () => {
                    // Simulate connection process
                    const testModal = document.getElementById('integrationTestModal');
                    testModal.classList.remove('hidden');
                    
                    setTimeout(() => {
                        // Simulate successful connection
                        integration.status = 'connected';
                        integration.lastSync = new Date().toISOString();
                        integration.settings.autoSync = true;
                        
                        // Add some demo data
                        if (integration.platform === 'google-ads') {
                            integration.dataImported = { campaigns: 12, keywords: 890, ads: 34 };
                        } else if (integration.platform === 'facebook-ads') {
                            integration.dataImported = { campaigns: 6, adSets: 18, ads: 54 };
                        } else if (integration.platform === 'linkedin-ads') {
                            integration.dataImported = { campaigns: 4, sponsored: 12, leads: 156 };
                        } else {
                            integration.dataImported = { items: Math.floor(Math.random() * 100) + 10 };
                        }
                        
                        saveToStorage();
                        renderIntegrationsGrid();
                        closeIntegrationTestModal();
                        
                        addIntegrationLog(
                            integration.name,
                            'Conexão estabelecida',
                            'success',
                            `Integração com ${integration.name} conectada com sucesso`,
                            `Dados importados: ${Object.entries(integration.dataImported).map(([k,v]) => `${v} ${k}`).join(', ')}`
                        );
                        
                        showSuccessMessage(`🎉 Integração com ${integration.name} conectada com sucesso! Sincronização automática ativada.`);
                    }, 3000);
                }
            );
        }

        function disconnectIntegration(id) {
            const integration = integrations.find(i => i.id === id);
            if (!integration) return;
            
            showConfirmModal(
                `🔌 DESCONECTAR INTEGRAÇÃO\n\nDeseja desconectar a integração com ${integration.name}?\n\n⚠️ O QUE ACONTECE:\n• Conexão com a API será interrompida\n• Sincronização automática será desativada\n• Dados existentes serão preservados\n• Pode ser reconectada a qualquer momento\n\nEsta é uma ação temporária e reversível.`,
                () => {
                    integration.status = 'pending';
                    integration.settings.autoSync = false;
                    
                    saveToStorage();
                    renderIntegrationsGrid();
                    
                    addIntegrationLog(
                        integration.name,
                        'Integração desconectada',
                        'info',
                        `Integração com ${integration.name} foi desconectada`,
                        'Sincronização automática desativada. Dados preservados.'
                    );
                    
                    showSuccessMessage(`🔌 Integração com ${integration.name} foi desconectada. Dados foram preservados.`);
                }
            );
        }

        function deleteIntegration(id) {
            const integration = integrations.find(i => i.id === id);
            if (!integration) return;
            
            showConfirmModal(
                `🗑️ REMOVER INTEGRAÇÃO PERMANENTEMENTE\n\nDeseja remover a integração com ${integration.name}?\n\n🚨 ATENÇÃO - AÇÃO IRREVERSÍVEL:\n• A integração será REMOVIDA permanentemente\n• TODAS as configurações serão PERDIDAS\n• Credenciais e dados de conexão serão APAGADOS\n• Histórico de sincronização será REMOVIDO\n• Esta ação NÃO PODE ser desfeita\n\n⚠️ Você precisará reconfigurar tudo do zero se quiser usar novamente.`,
                () => {
                    integrations = integrations.filter(i => i.id !== id);
                    
                    // Remove related logs
                    integrationLogs = integrationLogs.filter(log => log.platform !== integration.name);
                    
                    saveToStorage();
                    renderIntegrationsGrid();
                    renderIntegrationLogs();
                    
                    showSuccessMessage(`🗑️ Integração com ${integration.name} foi REMOVIDA permanentemente! Todas as configurações foram apagadas.`);
                }
            );
        }

        function syncIntegration(id) {
            const integration = integrations.find(i => i.id === id);
            if (!integration || integration.status !== 'connected') return;
            
            // Show loading state
            const button = event.target;
            const originalContent = button.innerHTML;
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            button.disabled = true;
            
            setTimeout(() => {
                // Simulate sync process
                integration.lastSync = new Date().toISOString();
                
                // Update imported data (simulate new data)
                Object.keys(integration.dataImported).forEach(key => {
                    integration.dataImported[key] += Math.floor(Math.random() * 5) + 1;
                });
                
                saveToStorage();
                renderIntegrationsGrid();
                
                addIntegrationLog(
                    integration.name,
                    'Sincronização manual',
                    'success',
                    `Dados sincronizados com ${integration.name}`,
                    `Novos dados importados: ${Object.entries(integration.dataImported).map(([k,v]) => `${v} ${k}`).join(', ')}`
                );
                
                // Restore button
                button.innerHTML = originalContent;
                button.disabled = false;
                
                showSuccessMessage(`🔄 Sincronização com ${integration.name} concluída! Novos dados foram importados.`);
            }, 2000);
        }

        function testIntegration(id) {
            const integration = integrations.find(i => i.id === id);
            if (!integration) return;
            
            document.getElementById('integrationTestModal').classList.remove('hidden');
            
            setTimeout(() => {
                const testResults = {
                    connection: Math.random() > 0.1, // 90% success rate
                    latency: Math.floor(Math.random() * 500) + 100,
                    dataAccess: Math.random() > 0.05, // 95% success rate
                    permissions: Math.random() > 0.02 // 98% success rate
                };
                
                const allPassed = Object.values(testResults).every(result => result === true || typeof result === 'number');
                
                document.getElementById('integration-test-content').innerHTML = `
                    <div class="space-y-4">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${allPassed ? 'bg-green-100' : 'bg-red-100'}">
                                <i class="fas ${allPassed ? 'fa-check text-green-600' : 'fa-times text-red-600'} text-2xl"></i>
                            </div>
                            <h3 class="text-lg font-semibold ${allPassed ? 'text-green-600' : 'text-red-600'}">
                                ${allPassed ? 'Teste Concluído com Sucesso!' : 'Teste Falhou'}
                            </h3>
                            <p class="text-gray-600 mt-2">Integração com ${integration.name}</p>
                        </div>
                        
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <span class="text-sm font-medium">Conexão com API</span>
                                <span class="flex items-center">
                                    <i class="fas ${testResults.connection ? 'fa-check text-green-500' : 'fa-times text-red-500'} mr-2"></i>
                                    ${testResults.connection ? 'Conectado' : 'Falha na conexão'}
                                </span>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <span class="text-sm font-medium">Latência</span>
                                <span class="flex items-center">
                                    <i class="fas fa-clock text-blue-500 mr-2"></i>
                                    ${testResults.latency}ms
                                </span>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <span class="text-sm font-medium">Acesso aos Dados</span>
                                <span class="flex items-center">
                                    <i class="fas ${testResults.dataAccess ? 'fa-check text-green-500' : 'fa-times text-red-500'} mr-2"></i>
                                    ${testResults.dataAccess ? 'Autorizado' : 'Sem permissão'}
                                </span>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <span class="text-sm font-medium">Permissões</span>
                                <span class="flex items-center">
                                    <i class="fas ${testResults.permissions ? 'fa-check text-green-500' : 'fa-times text-red-500'} mr-2"></i>
                                    ${testResults.permissions ? 'Válidas' : 'Insuficientes'}
                                </span>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3 pt-4">
                            <button onclick="closeIntegrationTestModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg hover:bg-gray-300">
                                Fechar
                            </button>
                            ${allPassed ? `
                                <button onclick="closeIntegrationTestModal(); showSuccessMessage('✅ Teste concluído! Integração funcionando perfeitamente.');" class="flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700">
                                    Perfeito!
                                </button>
                            ` : `
                                <button onclick="closeIntegrationTestModal(); configureIntegration(${id});" class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">
                                    Configurar
                                </button>
                            `}
                        </div>
                    </div>
                `;
                
                addIntegrationLog(
                    integration.name,
                    'Teste de conexão',
                    allPassed ? 'success' : 'error',
                    `Teste ${allPassed ? 'passou' : 'falhou'} para ${integration.name}`,
                    `Latência: ${testResults.latency}ms, Conexão: ${testResults.connection ? 'OK' : 'Falha'}`
                );
            }, 3000);
        }

        function configureIntegration(id) {
            const integration = integrations.find(i => i.id === id);
            if (!integration) return;
            
            document.getElementById('configModalTitle').textContent = `Configurar ${integration.name}`;
            
            const configContent = `
                <div class="space-y-6">
                    <!-- Connection Status -->
                    <div class="bg-${integration.status === 'connected' ? 'green' : 'yellow'}-50 p-4 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-${integration.status === 'connected' ? 'check-circle text-green-500' : 'clock text-yellow-500'} mr-3"></i>
                            <div>
                                <div class="font-medium">Status: ${integration.status === 'connected' ? 'Conectado' : 'Pendente'}</div>
                                <div class="text-sm text-gray-600">
                                    ${integration.lastSync ? `Última sincronização: ${new Date(integration.lastSync).toLocaleString('pt-BR')}` : 'Nunca sincronizado'}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sync Settings -->
                    <div>
                        <h4 class="text-lg font-semibold mb-4">Configurações de Sincronização</h4>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-medium">Sincronização Automática</div>
                                    <div class="text-sm text-gray-600">Importar dados automaticamente a cada intervalo</div>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" ${integration.settings.autoSync ? 'checked' : ''} class="sr-only peer" onchange="toggleAutoSync(${id})">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium mb-2">Intervalo de Sincronização</label>
                                <select class="w-full border rounded-lg px-3 py-2" onchange="updateSyncInterval(${id}, this.value)">
                                    <option value="900000" ${integration.syncInterval === 900000 ? 'selected' : ''}>15 minutos</option>
                                    <option value="1800000" ${integration.syncInterval === 1800000 ? 'selected' : ''}>30 minutos</option>
                                    <option value="3600000" ${integration.syncInterval === 3600000 ? 'selected' : ''}>1 hora</option>
                                    <option value="7200000" ${integration.syncInterval === 7200000 ? 'selected' : ''}>2 horas</option>
                                    <option value="21600000" ${integration.syncInterval === 21600000 ? 'selected' : ''}>6 horas</option>
                                    <option value="86400000" ${integration.syncInterval === 86400000 ? 'selected' : ''}>24 horas</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Data Import Settings -->
                    <div>
                        <h4 class="text-lg font-semibold mb-4">Dados para Importar</h4>
                        <div class="space-y-3">
                            ${Object.keys(integration.settings).filter(key => key.startsWith('import')).map(key => {
                                const label = key.replace('import', '').replace(/([A-Z])/g, ' $1').trim();
                                return `
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">${label}</div>
                                            <div class="text-sm text-gray-600">Importar ${label.toLowerCase()} da plataforma</div>
                                        </div>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" ${integration.settings[key] ? 'checked' : ''} class="sr-only peer" onchange="toggleImportSetting(${id}, '${key}')">
                                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    
                    <!-- Credentials (masked) -->
                    <div>
                        <h4 class="text-lg font-semibold mb-4">Credenciais</h4>
                        <div class="space-y-3">
                            ${Object.entries(integration.credentials).map(([key, value]) => `
                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                    <span class="font-medium">${key}</span>
                                    <span class="text-gray-600">${key.toLowerCase().includes('secret') || key.toLowerCase().includes('token') ? '***hidden***' : value}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <!-- Actions -->
                    <div class="flex space-x-3 pt-4 border-t">
                        <button onclick="closeIntegrationConfigModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg hover:bg-gray-300">
                            Fechar
                        </button>
                        <button onclick="testIntegration(${id}); closeIntegrationConfigModal();" class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">
                            Testar Conexão
                        </button>
                        <button onclick="syncIntegration(${id}); closeIntegrationConfigModal();" class="flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700">
                            Sincronizar Agora
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('integration-config-content').innerHTML = configContent;
            document.getElementById('integrationConfigModal').classList.remove('hidden');
        }

        function syncAllIntegrations() {
            const connectedIntegrations = integrations.filter(i => i.status === 'connected');
            
            if (connectedIntegrations.length === 0) {
                showErrorMessage('Nenhuma integração conectada para sincronizar.');
                return;
            }
            
            showConfirmModal(
                `🔄 SINCRONIZAR TODAS AS INTEGRAÇÕES\n\nDeseja sincronizar todas as ${connectedIntegrations.length} integrações conectadas?\n\n✅ O QUE ACONTECE:\n• Todas as integrações ativas serão sincronizadas\n• Novos dados serão importados de cada plataforma\n• Processo pode levar alguns minutos\n• Você será notificado quando concluir\n\nEsta operação irá atualizar todos os dados do sistema.`,
                () => {
                    let completed = 0;
                    const total = connectedIntegrations.length;
                    
                    connectedIntegrations.forEach((integration, index) => {
                        setTimeout(() => {
                            integration.lastSync = new Date().toISOString();
                            
                            // Update imported data
                            Object.keys(integration.dataImported).forEach(key => {
                                integration.dataImported[key] += Math.floor(Math.random() * 10) + 1;
                            });
                            
                            completed++;
                            
                            addIntegrationLog(
                                integration.name,
                                'Sincronização em lote',
                                'success',
                                `Sincronização automática concluída (${completed}/${total})`,
                                `Dados atualizados: ${Object.entries(integration.dataImported).map(([k,v]) => `${v} ${k}`).join(', ')}`
                            );
                            
                            if (completed === total) {
                                saveToStorage();
                                renderIntegrationsGrid();
                                showSuccessMessage(`🎉 Sincronização completa! Todas as ${total} integrações foram atualizadas com sucesso.`);
                            }
                        }, index * 1000); // Stagger the syncs
                    });
                }
            );
        }

        function clearIntegrationLogs() {
            showConfirmModal(
                `🗑️ LIMPAR LOGS DE INTEGRAÇÃO\n\nDeseja limpar todos os logs de atividades das integrações?\n\n⚠️ ATENÇÃO:\n• TODOS os logs serão removidos permanentemente\n• Histórico de sincronizações será perdido\n• Registros de erros e sucessos serão apagados\n• Esta ação NÃO PODE ser desfeita\n\nApenas os logs serão removidos, as integrações continuarão funcionando normalmente.`,
                () => {
                    integrationLogs = [];
                    saveToStorage();
                    renderIntegrationLogs();
                    showSuccessMessage('🗑️ Todos os logs de integração foram limpos!');
                }
            );
        }

        // Integration Settings Functions
        function toggleAutoSync(id) {
            const integration = integrations.find(i => i.id === id);
            if (integration) {
                integration.settings.autoSync = !integration.settings.autoSync;
                saveToStorage();
                
                addIntegrationLog(
                    integration.name,
                    'Configuração alterada',
                    'info',
                    `Sincronização automática ${integration.settings.autoSync ? 'ativada' : 'desativada'}`,
                    `Auto-sync: ${integration.settings.autoSync ? 'ON' : 'OFF'}`
                );
            }
        }

        function updateSyncInterval(id, interval) {
            const integration = integrations.find(i => i.id === id);
            if (integration) {
                integration.syncInterval = parseInt(interval);
                saveToStorage();
                
                const intervalText = {
                    900000: '15 minutos',
                    1800000: '30 minutos',
                    3600000: '1 hora',
                    7200000: '2 horas',
                    21600000: '6 horas',
                    86400000: '24 horas'
                };
                
                addIntegrationLog(
                    integration.name,
                    'Intervalo de sincronização alterado',
                    'info',
                    `Intervalo alterado para ${intervalText[interval]}`,
                    `Novo intervalo: ${intervalText[interval]}`
                );
            }
        }

        function toggleImportSetting(id, setting) {
            const integration = integrations.find(i => i.id === id);
            if (integration) {
                integration.settings[setting] = !integration.settings[setting];
                saveToStorage();
                
                const settingName = setting.replace('import', '').replace(/([A-Z])/g, ' $1').trim();
                addIntegrationLog(
                    integration.name,
                    'Configuração de importação alterada',
                    'info',
                    `Importação de ${settingName} ${integration.settings[setting] ? 'ativada' : 'desativada'}`,
                    `${settingName}: ${integration.settings[setting] ? 'ON' : 'OFF'}`
                );
            }
        }

        // Credentials editing functions
        function editCredentials(id) {
            const integration = integrations.find(i => i.id === id);
            if (!integration) return;
            
            document.getElementById('editCredentialsTitle').textContent = `Editar Credenciais - ${integration.name}`;
            document.getElementById('editIntegrationId').value = id;
            
            // Get platform configuration
            const platformConfigs = {
                'google-ads': {
                    fields: [
                        { name: 'clientId', label: 'Client ID', type: 'text', placeholder: 'Seu Google Ads Client ID', required: true },
                        { name: 'clientSecret', label: 'Client Secret', type: 'password', placeholder: 'Seu Client Secret', required: true },
                        { name: 'refreshToken', label: 'Refresh Token', type: 'password', placeholder: 'Token de atualização', required: true },
                        { name: 'customerId', label: 'Customer ID', type: 'text', placeholder: 'ID da conta (ex: 123-456-7890)', required: true }
                    ]
                },
                'facebook-ads': {
                    fields: [
                        { name: 'accessToken', label: 'Access Token', type: 'password', placeholder: 'Token de acesso do Facebook', required: true },
                        { name: 'appId', label: 'App ID', type: 'text', placeholder: 'ID da aplicação Facebook', required: true },
                        { name: 'appSecret', label: 'App Secret', type: 'password', placeholder: 'Secret da aplicação', required: true },
                        { name: 'adAccountId', label: 'Ad Account ID', type: 'text', placeholder: 'ID da conta de anúncios', required: true }
                    ]
                },
                'linkedin-ads': {
                    fields: [
                        { name: 'clientId', label: 'Client ID', type: 'text', placeholder: 'LinkedIn Client ID', required: true },
                        { name: 'clientSecret', label: 'Client Secret', type: 'password', placeholder: 'LinkedIn Client Secret', required: true },
                        { name: 'accessToken', label: 'Access Token', type: 'password', placeholder: 'Token de acesso', required: true },
                        { name: 'adAccountId', label: 'Ad Account ID', type: 'text', placeholder: 'ID da conta de anúncios', required: true }
                    ]
                },
                'google-analytics': {
                    fields: [
                        { name: 'trackingId', label: 'Tracking ID', type: 'text', placeholder: 'GA4 Measurement ID (G-XXXXXXXXXX)', required: true },
                        { name: 'serviceAccountKey', label: 'Service Account Key', type: 'textarea', placeholder: 'JSON da chave da conta de serviço', required: true },
                        { name: 'propertyId', label: 'Property ID', type: 'text', placeholder: 'ID da propriedade GA4', required: true }
                    ]
                },
                'shopify': {
                    fields: [
                        { name: 'shopDomain', label: 'Domínio da Loja', type: 'text', placeholder: 'minhaloja.myshopify.com', required: true },
                        { name: 'accessToken', label: 'Access Token', type: 'password', placeholder: 'Token de acesso privado', required: true },
                        { name: 'apiKey', label: 'API Key', type: 'text', placeholder: 'Chave da API', required: true },
                        { name: 'apiSecret', label: 'API Secret', type: 'password', placeholder: 'Secret da API', required: true }
                    ]
                },
                'webhook': {
                    fields: [
                        { name: 'webhookUrl', label: 'URL do Webhook', type: 'url', placeholder: 'https://api.exemplo.com/webhook', required: true },
                        { name: 'secretKey', label: 'Chave Secreta', type: 'password', placeholder: 'Chave para validação', required: false },
                        { name: 'method', label: 'Método HTTP', type: 'select', options: ['POST', 'PUT', 'PATCH'], required: true },
                        { name: 'headers', label: 'Headers Personalizados', type: 'textarea', placeholder: 'JSON com headers adicionais', required: false }
                    ]
                },
                'tiktok-ads': {
                    fields: [
                        { name: 'appId', label: 'App ID', type: 'text', placeholder: 'TikTok App ID', required: true },
                        { name: 'secret', label: 'Secret', type: 'password', placeholder: 'TikTok App Secret', required: true },
                        { name: 'accessToken', label: 'Access Token', type: 'password', placeholder: 'Token de acesso', required: true },
                        { name: 'advertiserId', label: 'Advertiser ID', type: 'text', placeholder: 'ID do anunciante', required: true }
                    ]
                },
                'twitter-ads': {
                    fields: [
                        { name: 'consumerKey', label: 'Consumer Key', type: 'text', placeholder: 'Twitter Consumer Key', required: true },
                        { name: 'consumerSecret', label: 'Consumer Secret', type: 'password', placeholder: 'Twitter Consumer Secret', required: true },
                        { name: 'accessToken', label: 'Access Token', type: 'password', placeholder: 'Token de acesso', required: true },
                        { name: 'accessTokenSecret', label: 'Access Token Secret', type: 'password', placeholder: 'Secret do token', required: true }
                    ]
                }
            };
            
            const config = platformConfigs[integration.platform];
            if (!config) return;
            
            const fieldsContainer = document.getElementById('edit-credentials-fields');
            fieldsContainer.innerHTML = config.fields.map(field => {
                const currentValue = integration.credentials[field.name] || '';
                const displayValue = field.type === 'password' && currentValue ? '***hidden***' : currentValue;
                
                if (field.type === 'select') {
                    return `
                        <div>
                            <label class="block text-sm font-medium mb-1">${field.label}</label>
                            <select name="${field.name}" class="w-full border rounded-lg px-3 py-2" ${field.required ? 'required' : ''}>
                                ${field.options.map(option => `
                                    <option value="${option}" ${currentValue === option ? 'selected' : ''}>${option}</option>
                                `).join('')}
                            </select>
                        </div>
                    `;
                } else if (field.type === 'textarea') {
                    return `
                        <div>
                            <label class="block text-sm font-medium mb-1">${field.label}</label>
                            <textarea name="${field.name}" class="w-full border rounded-lg px-3 py-2" rows="3" placeholder="${field.placeholder}" ${field.required ? 'required' : ''}>${field.type === 'password' ? '' : currentValue}</textarea>
                            ${field.type === 'password' && currentValue ? '<div class="text-xs text-gray-500 mt-1">Deixe em branco para manter o valor atual</div>' : ''}
                        </div>
                    `;
                } else {
                    return `
                        <div>
                            <label class="block text-sm font-medium mb-1">${field.label}</label>
                            <input type="${field.type}" name="${field.name}" class="w-full border rounded-lg px-3 py-2" placeholder="${field.placeholder}" value="${field.type === 'password' ? '' : currentValue}" ${field.required && !currentValue ? 'required' : ''}>
                            ${field.type === 'password' && currentValue ? '<div class="text-xs text-gray-500 mt-1">Deixe em branco para manter o valor atual</div>' : ''}
                        </div>
                    `;
                }
            }).join('');
            
            document.getElementById('editCredentialsModal').classList.remove('hidden');
        }

        function handleEditCredentials(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const integrationId = parseInt(formData.get('integrationId'));
            
            const integration = integrations.find(i => i.id === integrationId);
            if (!integration) return;
            
            // Update credentials, keeping existing values if field is empty (for password fields)
            const updatedCredentials = { ...integration.credentials };
            let hasChanges = false;
            
            for (let [key, value] of formData.entries()) {
                if (key !== 'integrationId' && value.trim()) {
                    if (updatedCredentials[key] !== value.trim()) {
                        updatedCredentials[key] = value.trim();
                        hasChanges = true;
                    }
                }
            }
            
            if (!hasChanges) {
                showErrorMessage('Nenhuma alteração foi detectada nas credenciais.');
                return;
            }
            
            // Validate required fields
            const requiredFields = getRequiredFieldsForPlatform(integration.platform);
            const missingFields = requiredFields.filter(field => !updatedCredentials[field]);
            
            if (missingFields.length > 0) {
                showErrorMessage(`Campos obrigatórios não preenchidos: ${missingFields.join(', ')}`);
                return;
            }
            
            // Update integration
            integration.credentials = updatedCredentials;
            
            // If integration was connected, change status to configured (needs reconnection)
            if (integration.status === 'connected') {
                integration.status = 'configured';
                integration.lastSync = null;
                integration.settings.autoSync = false;
            }
            
            saveToStorage();
            renderIntegrationsGrid();
            closeEditCredentialsModal();
            
            addIntegrationLog(
                integration.name,
                'Credenciais atualizadas',
                'success',
                `Credenciais do ${integration.name} foram atualizadas`,
                `Campos alterados: ${Object.keys(updatedCredentials).join(', ')}`
            );
            
            showSuccessMessage(`🔐 Credenciais do ${integration.name} atualizadas com sucesso! ${integration.status === 'configured' ? 'Reconecte para ativar a sincronização.' : ''}`);
        }

        function closeEditCredentialsModal() {
            document.getElementById('editCredentialsModal').classList.add('hidden');
            document.getElementById('editCredentialsModal').querySelector('form').reset();
        }

        // Modal close functions
        function closeIntegrationConfigModal() {
            document.getElementById('integrationConfigModal').classList.add('hidden');
        }

        function closeIntegrationTestModal() {
            document.getElementById('integrationTestModal').classList.add('hidden');
        }

        // Initialize Charts
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize dark mode
            initializeDarkMode();
            
            // Load data from localStorage first
            campaigns = JSON.parse(localStorage.getItem('trafficpro_campaigns')) || campaigns;
            clients = JSON.parse(localStorage.getItem('trafficpro_clients')) || clients;
            integrations = JSON.parse(localStorage.getItem('trafficpro_integrations')) || integrations;
            integrationLogs = JSON.parse(localStorage.getItem('trafficpro_integration_logs')) || integrationLogs;
            
            // Initialize filters after loading data
            filteredCampaigns = [...campaigns];
            filteredClients = [...clients];
            
            // Initialize data displays
            renderCampaignTable();
            renderClientsGrid();
            renderIntegrationsGrid();
            renderIntegrationLogs();
            
            // Save initial data if localStorage is empty
            if (!localStorage.getItem('trafficpro_campaigns')) {
                saveToStorage();
            }
            // Channel Performance Chart
            const channelCtx = document.getElementById('channelChart').getContext('2d');
            new Chart(channelCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Facebook Ads', 'Google Ads', 'LinkedIn Ads'],
                    datasets: [{
                        data: [45, 35, 20],
                        backgroundColor: ['#3B82F6', '#EF4444', '#8B5CF6'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // ROI Chart
            const roiCtx = document.getElementById('roiChart').getContext('2d');
            new Chart(roiCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                    datasets: [{
                        label: 'Investimento',
                        data: [30000, 35000, 32000, 40000, 38000, 45000],
                        borderColor: '#EF4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'Retorno',
                        data: [120000, 140000, 128000, 168000, 152000, 190000],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });

            // Budget Chart
            const budgetCtx = document.getElementById('budgetChart').getContext('2d');
            new Chart(budgetCtx, {
                type: 'bar',
                data: {
                    labels: ['Loja Fashion', 'TechStart', 'E-commerce Plus'],
                    datasets: [{
                        label: 'Orçamento',
                        data: [20000, 15000, 10000],
                        backgroundColor: 'rgba(59, 130, 246, 0.5)',
                        borderColor: '#3B82F6',
                        borderWidth: 1
                    }, {
                        label: 'Gasto',
                        data: [15200, 8900, 5400],
                        backgroundColor: 'rgba(239, 68, 68, 0.5)',
                        borderColor: '#EF4444',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });

            // Funnel Chart
            const funnelCtx = document.getElementById('funnelChart').getContext('2d');
            new Chart(funnelCtx, {
                type: 'bar',
                data: {
                    labels: ['Impressões', 'Cliques', 'Visitas', 'Leads', 'Conversões'],
                    datasets: [{
                        data: [1500000, 42000, 38000, 5200, 1847],
                        backgroundColor: [
                            '#3B82F6',
                            '#10B981',
                            '#F59E0B',
                            '#EF4444',
                            '#8B5CF6'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            type: 'logarithmic'
                        }
                    }
                }
            });

            // Time Chart
            const timeCtx = document.getElementById('timeChart').getContext('2d');
            new Chart(timeCtx, {
                type: 'line',
                data: {
                    labels: ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4'],
                    datasets: [{
                        label: 'ROAS',
                        data: [3.2, 4.1, 3.8, 4.2],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 5,
                            ticks: {
                                callback: function(value) {
                                    return value + 'x';
                                }
                            }
                        }
                    }
                }
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96ba8153051864bd',t:'MTc1NDYwODgzMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
